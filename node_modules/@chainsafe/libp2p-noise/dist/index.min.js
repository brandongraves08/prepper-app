(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var ll=Object.create;var Pn=Object.defineProperty;var pl=Object.getOwnPropertyDescriptor;var dl=Object.getOwnPropertyNames;var yl=Object.getPrototypeOf,gl=Object.prototype.hasOwnProperty;var xl=(e,t,r)=>t in e?Pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Q=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),$t=(e,t)=>{for(var r in t)Pn(e,r,{get:t[r],enumerable:!0})},u0=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of dl(t))!gl.call(e,i)&&i!==r&&Pn(e,i,{get:()=>t[i],enumerable:!(n=pl(t,i))||n.enumerable});return e};var _t=(e,t,r)=>(r=e!=null?ll(yl(e)):{},u0(t||!e||!e.__esModule?Pn(r,"default",{value:e,enumerable:!0}):r,e)),ml=e=>u0(Pn({},"__esModule",{value:!0}),e);var Si=(e,t,r)=>(xl(e,typeof t!="symbol"?t+"":t,r),r);var Fo=Q((Ox,y0)=>{"use strict";function d0(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function _l(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return d0(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),d0(new i,r)}}y0.exports=_l});var gt=Q((Jb,dc)=>{dc.exports={options:{usePureJavaScript:!1}}});var xc=Q((tw,gc)=>{var gs={};gc.exports=gs;var yc={};gs.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=od(e,t);else{var i=0,o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,f=e[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%o,f=f/o|0;for(;f>0;)a.push(f%o),f=f/o|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};gs.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=yc[t];if(!r){r=yc[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,o=t.charAt(0),s=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<s.length;++c)f+=s[c]*i,s[c]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var u=0;e[u]===o&&u<e.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function od(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var s=0,a=e.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=t[o[r]];return c}});var Pt=Q((ew,vc)=>{var mc=gt(),bc=xc(),x=vc.exports=mc.util=mc.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(a){return setImmediate(a)};return}if(x.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var f=t.slice();t.length=0,f.forEach(function(u){u()})}};var s=a,e="forge.setImmediate",t=[];x.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var o=x.setImmediate;x.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),o(c)):(t.push(c),t.length===1&&i.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};x.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};x.isArrayBufferView=function(e){return e&&x.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function $n(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}x.ByteBuffer=xs;function xs(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(x.isArrayBuffer(e)||x.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof xs||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}x.ByteStringBuffer=xs;var sd=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>sd&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};x.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};x.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};x.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(x.encodeUtf8(e))};x.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};x.ByteStringBuffer.prototype.putInt=function(e,t){$n(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};x.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};x.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};x.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};x.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};x.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};x.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};x.ByteStringBuffer.prototype.getInt=function(e){$n(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};x.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};x.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};x.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};x.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};x.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var e=x.createBuffer(this.data);return e.read=this.read,e};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function ad(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=x.isArrayBuffer(e),n=x.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}x.DataBuffer=ad;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};x.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};x.DataBuffer.prototype.putBytes=function(e,t){if(x.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(x.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof x.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&x.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof x.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var o;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(e,o,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(e,o,this.write),this;if(t==="utf8"&&(e=x.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(o),this;if(t==="utf16")return this.accommodate(e.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};x.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};x.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};x.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(e,t){$n(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};x.DataBuffer.prototype.putSignedInt=function(e,t){return $n(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};x.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};x.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};x.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};x.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};x.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};x.DataBuffer.prototype.getInt=function(e){$n(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};x.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};x.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};x.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};x.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};x.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};x.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return x.binary.raw.encode(t);if(e==="hex")return x.binary.hex.encode(t);if(e==="base64")return x.binary.base64.encode(t);if(e==="utf8")return x.text.utf8.decode(t);if(e==="utf16")return x.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};x.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=x.encodeUtf8(e)),new x.ByteBuffer(e)};x.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};x.xorBytes=function(e,t,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};x.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};x.bytesToHex=function(e){return x.createBuffer(e).toHex()};x.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var lr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],wc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(e,t){for(var r="",n="",i,o,s,a=0;a<e.length;)i=e.charCodeAt(a++),o=e.charCodeAt(a++),s=e.charCodeAt(a++),r+=lr.charAt(i>>2),r+=lr.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=lr.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":lr.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};x.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,o,s=0;s<e.length;)r=pr[e.charCodeAt(s++)-43],n=pr[e.charCodeAt(s++)-43],i=pr[e.charCodeAt(s++)-43],o=pr[e.charCodeAt(s++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(t+=String.fromCharCode((i&3)<<6|o)));return t};x.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};x.decodeUtf8=function(e){return decodeURIComponent(escape(e))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:bc.encode,decode:bc.decode}};x.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};x.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,o=r;for(e.length&1&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n};x.binary.base64.encode=function(e,t){for(var r="",n="",i,o,s,a=0;a<e.byteLength;)i=e[a++],o=e[a++],s=e[a++],r+=lr.charAt(i>>2),r+=lr.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=lr.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":lr.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};x.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,c=0,f=r;c<e.length;)i=pr[e.charCodeAt(c++)-43],o=pr[e.charCodeAt(c++)-43],s=pr[e.charCodeAt(c++)-43],a=pr[e.charCodeAt(c++)-43],n[f++]=i<<2|o>>4,s!==64&&(n[f++]=(o&15)<<4|s>>2,a!==64&&(n[f++]=(s&3)<<6|a));return t?f-r:n.subarray(0,f)};x.binary.base58.encode=function(e,t){return x.binary.baseN.encode(e,wc,t)};x.binary.base58.decode=function(e,t){return x.binary.baseN.decode(e,wc,t)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(e,t,r){e=x.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n};x.text.utf8.decode=function(e){return x.decodeUtf8(String.fromCharCode.apply(null,e))};x.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<e.length;++a)i[s++]=e.charCodeAt(a),o+=2;return t?o-r:n};x.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};x.deflate=function(e,t,r){if(t=x.decode64(e.deflate(x.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};x.inflate=function(e,t,r){var n=e.inflate(x.encode64(t)).rval;return n===null?null:x.decode64(n)};var ms=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=x.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},bs=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},cd=function(e,t,r,n){var i=bs(e,t);i===null&&(i={}),i[r]=n,ms(e,t,i)},fd=function(e,t,r){var n=bs(e,t);return n!==null&&(n=r in n?n[r]:null),n},ud=function(e,t,r){var n=bs(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),ms(e,t,n)}},hd=function(e,t){ms(e,t,null)},Gi=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),o=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),o=!0)}catch(c){s=c}if(o)break}if(!o)throw s;return n};x.setItem=function(e,t,r,n,i){Gi(cd,arguments,i)};x.getItem=function(e,t,r,n){return Gi(fd,arguments,n)};x.removeItem=function(e,t,r,n){Gi(ud,arguments,n)};x.clearItems=function(e,t,r){Gi(hd,arguments,r)};x.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};x.format=function(e){for(var t=/%./g,r,n,i=0,o=[],s=0;r=t.exec(e);){n=e.substring(s,t.lastIndex-2),n.length>0&&o.push(n),s=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(e.substring(s)),o.join("")};x.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,s=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-f).toFixed(o).slice(2):"")};x.formatSize=function(e){return e>=1073741824?e=x.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=x.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=x.formatNumber(e/1024,0)+" KiB":e=x.formatNumber(e,0)+" bytes",e};x.bytesFromIP=function(e){return e.indexOf(".")!==-1?x.bytesFromIPv4(e):e.indexOf(":")!==-1?x.bytesFromIPv6(e):null};x.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=x.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};x.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=x.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=x.hexToBytes(e[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};x.bytesToIP=function(e){return e.length===4?x.bytesToIPv4(e):e.length===16?x.bytesToIPv6(e):null};x.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};x.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var o=x.bytesToHex(e[i]+e[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=t.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(o)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};x.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in x&&!e.update)return t(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,t(null,x.cores);if(typeof Worker>"u")return x.cores=1,t(null,x.cores);if(typeof Blob>"u")return x.cores=2,t(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,c){if(a===0){var f=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return x.cores=Math.max(1,f),URL.revokeObjectURL(r),t(null,x.cores)}i(c,function(u,h){s.push(o(c,h)),n(s,a-1,c)})}function i(s,a){for(var c=[],f=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===s){for(var d=0;d<s;++d)c[d].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<s;++u)c[u].postMessage(u)}function o(s,a){for(var c=[],f=0;f<s;++f)for(var u=a[f],h=c[f]=[],l=0;l<s;++l)if(f!==l){var d=a[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return c.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var $i=Q((rw,Ec)=>{var Wn=gt();Wn.pki=Wn.pki||{};var ws=Ec.exports=Wn.pki.oids=Wn.oids=Wn.oids||{};function T(e,t){ws[e]=t,ws[t]=e}function yt(e,t){ws[e]=t}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");yt("2.5.29.1","authorityKeyIdentifier");yt("2.5.29.2","keyAttributes");yt("2.5.29.3","certificatePolicies");yt("2.5.29.4","keyUsageRestriction");yt("2.5.29.5","policyMapping");yt("2.5.29.6","subtreesConstraint");yt("2.5.29.7","subjectAltName");yt("2.5.29.8","issuerAltName");yt("2.5.29.9","subjectDirectoryAttributes");yt("2.5.29.10","basicConstraints");yt("2.5.29.11","nameConstraints");yt("2.5.29.12","policyConstraints");yt("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");yt("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");yt("2.5.29.20","cRLNumber");yt("2.5.29.21","cRLReason");yt("2.5.29.22","expirationDate");yt("2.5.29.23","instructionCode");yt("2.5.29.24","invalidityDate");yt("2.5.29.25","cRLDistributionPoints");yt("2.5.29.26","issuingDistributionPoint");yt("2.5.29.27","deltaCRLIndicator");yt("2.5.29.28","issuingDistributionPoint");yt("2.5.29.29","certificateIssuer");yt("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");yt("2.5.29.33","policyMappings");yt("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");yt("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");yt("2.5.29.46","freshestCRL");yt("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Yn=Q((nw,Bc)=>{var wt=gt();Pt();$i();var U=Bc.exports=wt.asn1=wt.asn1||{};U.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};U.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};U.create=function(e,t,r,n,i){if(wt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:e,type:t,constructed:r,composed:r||wt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=U.copy(a)),a};U.copy=function(e,t){var r;if(wt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(U.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:U.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};U.equals=function(e,t,r){if(wt.util.isArray(e)){if(!wt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!U.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&U.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};U.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Zn(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var ld=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Zn(e,t,o),n=e.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};U.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=wt.util.createBuffer(e));var r=e.length(),n=Wi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Wi(e,t,r,n){var i;Zn(e,t,2);var o=e.getByte();t--;var s=o&192,a=o&31;i=e.length();var c=ld(e,t);if(t-=i-e.length(),c!==void 0&&c>t){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=c,f}c=t}var u,h,l=(o&32)===32;if(l)if(u=[],c===void 0)for(;;){if(Zn(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),u.push(Wi(e,t,r+1,n)),t-=i-e.length()}else for(;c>0;)i=e.length(),u.push(Wi(e,c,r+1,n)),t-=i-e.length(),c-=i-e.length();if(u===void 0&&s===U.Class.UNIVERSAL&&a===U.Type.BITSTRING&&(h=e.bytes(c)),u===void 0&&n.decodeBitStrings&&s===U.Class.UNIVERSAL&&a===U.Type.BITSTRING&&c>1){var d=e.read,p=t,y=0;if(a===U.Type.BITSTRING&&(Zn(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var g={strict:!0,decodeBitStrings:!0},m=Wi(e,t,r+1,g),E=i-e.length();t-=E,a==U.Type.BITSTRING&&E++;var b=m.tagClass;E===c&&(b===U.Class.UNIVERSAL||b===U.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(e.read=d,t=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(a===U.Type.BMPSTRING)for(u="";c>0;c-=2)Zn(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(c),t-=c}var C=h===void 0?null:{bitStringContents:h};return U.create(s,a,l,u,C)}U.toDer=function(e){var t=wt.util.createBuffer(),r=e.tagClass|e.type,n=wt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=U.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var o=0;o<e.value.length;++o)e.value[o]!==void 0&&n.putBuffer(U.toDer(e.value[o]))}else if(e.type===U.Type.BMPSTRING)for(var o=0;o<e.value.length;++o)n.putInt16(e.value.charCodeAt(o));else e.type===U.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)t.putByte(a.charCodeAt(o))}return t.putBuffer(n),t};U.oidToDer=function(e){var t=e.split("."),r=wt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,o,s,a=2;a<t.length;++a){n=!0,i=[],o=parseInt(t[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};U.derToOid=function(e){var t;typeof e=="string"&&(e=wt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};U.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(e.substr(10,2),10),f+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,0),f&&(c=e.charAt(f),c==="+"||c==="-")){var u=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};U.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,f=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);f=d*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,c),t.setTime(+t+f)):(t.setFullYear(r,n,i),t.setHours(o,s,a,c)),t};U.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.integerToDer=function(e){var t=wt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};U.derToInteger=function(e){typeof e=="string"&&(e=wt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};U.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&wt.util.isArray(t.value))for(var o=0,s=0;i&&s<t.value.length;++s)i=t.value[s].optional||!1,e.value[o]&&(i=U.validate(e.value[o],t.value[s],r,n),i?++o:t.value[s].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var Sc=/[^\\u0000-\\u00ff]/;U.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",o=0;o<t*r;++o)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case U.Class.UNIVERSAL:n+="Universal:";break;case U.Class.APPLICATION:n+="Application:";break;case U.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case U.Class.PRIVATE:n+="Private:";break}if(e.tagClass===U.Class.UNIVERSAL)switch(n+=e.type,e.type){case U.Type.NONE:n+=" (None)";break;case U.Type.BOOLEAN:n+=" (Boolean)";break;case U.Type.INTEGER:n+=" (Integer)";break;case U.Type.BITSTRING:n+=" (Bit string)";break;case U.Type.OCTETSTRING:n+=" (Octet string)";break;case U.Type.NULL:n+=" (Null)";break;case U.Type.OID:n+=" (Object Identifier)";break;case U.Type.ODESC:n+=" (Object Descriptor)";break;case U.Type.EXTERNAL:n+=" (External or Instance of)";break;case U.Type.REAL:n+=" (Real)";break;case U.Type.ENUMERATED:n+=" (Enumerated)";break;case U.Type.EMBEDDED:n+=" (Embedded PDV)";break;case U.Type.UTF8:n+=" (UTF8)";break;case U.Type.ROID:n+=" (Relative Object Identifier)";break;case U.Type.SEQUENCE:n+=" (Sequence)";break;case U.Type.SET:n+=" (Set)";break;case U.Type.PRINTABLESTRING:n+=" (Printable String)";break;case U.Type.IA5String:n+=" (IA5String (ASCII))";break;case U.Type.UTCTIME:n+=" (UTC time)";break;case U.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case U.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,a="",o=0;o<e.value.length;++o)e.value[o]!==void 0&&(s+=1,a+=U.prettyPrint(e.value[o],t+1,r),o+1<e.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",e.type===U.Type.OID){var c=U.derToOid(e.value);n+=c,wt.pki&&wt.pki.oids&&c in wt.pki.oids&&(n+=" ("+wt.pki.oids[c]+") ")}if(e.type===U.Type.INTEGER)try{n+=U.derToInteger(e.value)}catch{n+="0x"+wt.util.bytesToHex(e.value)}else if(e.type===U.Type.BITSTRING){if(e.value.length>1?n+="0x"+wt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(e.type===U.Type.OCTETSTRING)Sc.test(e.value)||(n+="("+e.value+") "),n+="0x"+wt.util.bytesToHex(e.value);else if(e.type===U.Type.UTF8)try{n+=wt.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+wt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===U.Type.PRINTABLESTRING||e.type===U.Type.IA5String?n+=e.value:Sc.test(e.value)?n+="0x"+wt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var Es=Q((iw,Ac)=>{var Mt=gt();Pt();Ac.exports=Mt.cipher=Mt.cipher||{};Mt.cipher.algorithms=Mt.cipher.algorithms||{};Mt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Mt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Mt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Mt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Mt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Mt.cipher.algorithms[e]=t};Mt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Mt.cipher.algorithms?Mt.cipher.algorithms[e]:null};var vs=Mt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};vs.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Mt.util.createBuffer(),this.output=e.output||Mt.util.createBuffer(),this.mode.start(t)};vs.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};vs.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Bs=Q((ow,Cc)=>{var Ht=gt();Pt();Ht.cipher=Ht.cipher||{};var rt=Cc.exports=Ht.cipher.modes=Ht.cipher.modes||{};rt.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};rt.ecb.prototype.start=function(e){};rt.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};rt.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};rt.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};rt.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};rt.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};rt.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Zi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};rt.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};rt.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};rt.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};rt.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};rt.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.ofb.prototype.decrypt=rt.ofb.prototype.encrypt;rt.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Yi(this._inBlock)};rt.ctr.prototype.decrypt=rt.ctr.prototype.encrypt;rt.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0,this._R=3774873600};rt.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Ht.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Ht.util.createBuffer(e.additionalData):r=Ht.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Ht.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ss(n*8)))}this._inBlock=this._j0.slice(0),Yi(this._inBlock),this._partialBytes=0,r=Ht.util.createBuffer(r),this._aDataLength=Ss(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};rt.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Yi(this._inBlock)};rt.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Yi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};rt.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Ht.util.createBuffer();var n=this._aDataLength.concat(Ss(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};rt.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var o=e[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};rt.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};rt.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,o=this._m[r][i];t[0]^=o[0],t[1]^=o[1],t[2]^=o[2],t[3]^=o[3]}return t};rt.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};rt.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=s/n|0,f=(n-1-s%n)*t;a[c]=1<<t-1<<f,o[s]=this.generateSubHashTable(this.multiply(a,e),t)}return o};rt.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var f=i[o^n];i[o]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return i};function Zi(e,t){if(typeof e=="string"&&(e=Ht.util.createBuffer(e)),Ht.util.isArray(e)&&e.length>4){var r=e;e=Ht.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Ht.util.isArray(e)){for(var i=[],o=t/4,n=0;n<o;++n)i.push(e.getInt32());e=i}return e}function Yi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Ss(e){return[e/4294967296|0,e&4294967295]}});var _s=Q((sw,Lc)=>{var mt=gt();Es();Bs();Pt();Lc.exports=mt.aes=mt.aes||{};mt.aes.startEncrypting=function(e,t,r,n){var i=Xi({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};mt.aes.createEncryptionCipher=function(e,t){return Xi({key:e,output:null,decrypt:!1,mode:t})};mt.aes.startDecrypting=function(e,t,r,n){var i=Xi({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};mt.aes.createDecryptionCipher=function(e,t){return Xi({key:e,output:null,decrypt:!0,mode:t})};mt.aes.Algorithm=function(e,t){Is||_c();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return Cs(r._w,n,i,!1)},decrypt:function(n,i){return Cs(r._w,n,i,!0)}}}),r._init=!1};mt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=mt.util.createBuffer(t);else if(mt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=mt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!mt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!mt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=Tc(t,e.decrypt&&!s),this._init=!0}};mt.aes._expandKey=function(e,t){return Is||_c(),Tc(e,t)};mt.aes._updateBlock=Cs;an("AES-ECB",mt.cipher.modes.ecb);an("AES-CBC",mt.cipher.modes.cbc);an("AES-CFB",mt.cipher.modes.cfb);an("AES-OFB",mt.cipher.modes.ofb);an("AES-CTR",mt.cipher.modes.ctr);an("AES-GCM",mt.cipher.modes.gcm);function an(e,t){var r=function(){return new mt.aes.Algorithm(e,t)};mt.cipher.registerAlgorithm(e,r)}var Is=!1,sn=4,jt,As,Ic,Rr,Se;function _c(){Is=!0,Ic=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;jt=new Array(256),As=new Array(256),Rr=new Array(4),Se=new Array(4);for(var t=0;t<4;++t)Rr[t]=new Array(256),Se[t]=new Array(256);for(var r=0,n=0,i,o,s,a,c,f,u,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,jt[r]=a,As[a]=r,c=e[a],i=e[r],o=e[i],s=e[o],f=c<<24^a<<16^a<<8^(a^c),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)Rr[h][r]=f,Se[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^s]]],n^=e[e[n]])}}function Tc(e,t){for(var r=e.slice(0),n,i=1,o=r.length,s=o+6+1,a=sn*s,c=o;c<a;++c)n=r[c-1],c%o===0?(n=jt[n>>>16&255]<<24^jt[n>>>8&255]<<16^jt[n&255]<<8^jt[n>>>24]^Ic[i]<<24,i++):o>6&&c%o===4&&(n=jt[n>>>24]<<24^jt[n>>>16&255]<<16^jt[n>>>8&255]<<8^jt[n&255]),r[c]=r[c-o]^n;if(t){var f,u=Se[0],h=Se[1],l=Se[2],d=Se[3],p=r.slice(0);a=r.length;for(var c=0,y=a-sn;c<a;c+=sn,y-=sn)if(c===0||c===a-sn)p[c]=r[y],p[c+1]=r[y+3],p[c+2]=r[y+2],p[c+3]=r[y+1];else for(var g=0;g<sn;++g)f=r[y+g],p[c+(3&-g)]=u[jt[f>>>24]]^h[jt[f>>>16&255]]^l[jt[f>>>8&255]]^d[jt[f&255]];r=p}return r}function Cs(e,t,r,n){var i=e.length/4-1,o,s,a,c,f;n?(o=Se[0],s=Se[1],a=Se[2],c=Se[3],f=As):(o=Rr[0],s=Rr[1],a=Rr[2],c=Rr[3],f=jt);var u,h,l,d,p,y,g;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var m=3,E=1;E<i;++E)p=o[u>>>24]^s[h>>>16&255]^a[l>>>8&255]^c[d&255]^e[++m],y=o[h>>>24]^s[l>>>16&255]^a[d>>>8&255]^c[u&255]^e[++m],g=o[l>>>24]^s[d>>>16&255]^a[u>>>8&255]^c[h&255]^e[++m],d=o[d>>>24]^s[u>>>16&255]^a[h>>>8&255]^c[l&255]^e[++m],u=p,h=y,l=g;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[d&255]^e[++m],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[d>>>8&255]<<8^f[u&255]^e[++m],r[2]=f[l>>>24]<<24^f[d>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^e[++m],r[n?1:3]=f[d>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^e[++m]}function Xi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=mt.cipher.createDecipher(r,e.key):n=mt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof mt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var kc=Q((aw,Nc)=>{var Bt=gt();Es();Bs();Pt();Nc.exports=Bt.des=Bt.des||{};Bt.des.startEncrypting=function(e,t,r,n){var i=Qi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Bt.des.createEncryptionCipher=function(e,t){return Qi({key:e,output:null,decrypt:!1,mode:t})};Bt.des.startDecrypting=function(e,t,r,n){var i=Qi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Bt.des.createDecryptionCipher=function(e,t){return Qi({key:e,output:null,decrypt:!0,mode:t})};Bt.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Rc(r._keys,n,i,!1)},decrypt:function(n,i){return Rc(r._keys,n,i,!0)}}}),r._init=!1};Bt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Bt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=vd(t),this._init=!0}};Ne("DES-ECB",Bt.cipher.modes.ecb);Ne("DES-CBC",Bt.cipher.modes.cbc);Ne("DES-CFB",Bt.cipher.modes.cfb);Ne("DES-OFB",Bt.cipher.modes.ofb);Ne("DES-CTR",Bt.cipher.modes.ctr);Ne("3DES-ECB",Bt.cipher.modes.ecb);Ne("3DES-CBC",Bt.cipher.modes.cbc);Ne("3DES-CFB",Bt.cipher.modes.cfb);Ne("3DES-OFB",Bt.cipher.modes.ofb);Ne("3DES-CTR",Bt.cipher.modes.ctr);function Ne(e,t){var r=function(){return new Bt.des.Algorithm(e,t)};Bt.cipher.registerAlgorithm(e,r)}var pd=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],dd=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],yd=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],gd=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],xd=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],md=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],bd=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],wd=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function vd(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,g=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,C=0;C<y;C++){var v=e.getInt32(),A=e.getInt32();b=(v>>>4^A)&252645135,A^=b,v^=b<<4,b=(A>>>-16^v)&65535,v^=b,A^=b<<-16,b=(v>>>2^A)&858993459,A^=b,v^=b<<2,b=(A>>>-16^v)&65535,v^=b,A^=b<<-16,b=(v>>>1^A)&1431655765,A^=b,v^=b<<1,b=(A>>>8^v)&16711935,v^=b,A^=b<<8,b=(v>>>1^A)&1431655765,A^=b,v^=b<<1,b=v<<8|A>>>20&240,v=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=b;for(var P=0;P<m.length;++P){m[P]?(v=v<<2|v>>>26,A=A<<2|A>>>26):(v=v<<1|v>>>27,A=A<<1|A>>>27),v&=-15,A&=-15;var k=t[v>>>28]|r[v>>>24&15]|n[v>>>20&15]|i[v>>>16&15]|o[v>>>12&15]|s[v>>>8&15]|a[v>>>4&15],R=c[A>>>28]|f[A>>>24&15]|u[A>>>20&15]|h[A>>>16&15]|l[A>>>12&15]|d[A>>>8&15]|p[A>>>4&15];b=(R>>>16^k)&65535,g[E++]=k^b,g[E++]=R^b<<16}}return g}function Rc(e,t,r,n){var i=e.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=t[0],c=t[1];s=(a>>>4^c)&252645135,c^=s,a^=s<<4,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=o[f+1],h=o[f+2],l=o[f];l!=u;l+=h){var d=c^e[l],p=(c>>>4|c<<28)^e[l+1];s=a,a=c,c=s^(dd[d>>>24&63]|gd[d>>>16&63]|md[d>>>8&63]|wd[d&63]|pd[p>>>24&63]|yd[p>>>16&63]|xd[p>>>8&63]|bd[p&63])}s=a,a=c,c=s}a=a>>>1|a<<31,c=c>>>1|c<<31,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(a>>>4^c)&252645135,c^=s,a^=s<<4,r[0]=a,r[1]=c}function Qi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=Bt.cipher.createDecipher(r,e.key):n=Bt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof Bt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Nr=Q((cw,Dc)=>{var ji=gt();Dc.exports=ji.md=ji.md||{};ji.md.algorithms=ji.md.algorithms||{}});var Pc=Q((fw,Uc)=>{var Xe=gt();Nr();Pt();var Ed=Uc.exports=Xe.hmac=Xe.hmac||{};Ed.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Xe.md.algorithms)t=Xe.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else t=o;if(s===null)s=e;else{if(typeof s=="string")s=Xe.util.createBuffer(s);else if(Xe.util.isArray(s)){var a=s;s=Xe.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var f=s.length();f>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=Xe.util.createBuffer(),n=Xe.util.createBuffer(),f=s.length();for(var c=0;c<f;++c){var a=s.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<t.blockLength)for(var a=t.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);e=s,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(o){t.update(o)},i.getMac=function(){var o=t.digest().bytes();return t.start(),t.update(n),t.update(o),t.digest()},i.digest=i.getMac,i}});var cn=Q(()=>{});var Oc=Q((lw,Kc)=>{var Jt=gt();Pc();Nr();Pt();var Sd=Jt.pkcs5=Jt.pkcs5||{},Qe;Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&(Qe=cn());Kc.exports=Jt.pbkdf2=Sd.pbkdf2=function(e,t,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&Qe.pbkdf2&&(i===null||typeof i!="object")&&(Qe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),o?Qe.pbkdf2Sync.length===4?Qe.pbkdf2(e,t,r,n,function(b,C){if(b)return o(b);o(null,C.toString("binary"))}):Qe.pbkdf2(e,t,r,n,i,function(b,C){if(b)return o(b);o(null,C.toString("binary"))}):Qe.pbkdf2Sync.length===4?Qe.pbkdf2Sync(e,t,r,n).toString("binary"):Qe.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Jt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Jt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var c=Math.ceil(n/s),f=n-(c-1)*s,u=Jt.hmac.create();u.start(i,e);var h="",l,d,p;if(!o){for(var y=1;y<=c;++y){u.start(null,null),u.update(t),u.update(Jt.util.int32ToBytes(y)),l=p=u.digest().getBytes();for(var g=2;g<=r;++g)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Jt.util.xorBytes(l,d,s),p=d;h+=y<c?l:l.substr(0,f)}return h}var y=1,g;function m(){if(y>c)return o(null,h);u.start(null,null),u.update(t),u.update(Jt.util.int32ToBytes(y)),l=p=u.digest().getBytes(),g=2,E()}function E(){if(g<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Jt.util.xorBytes(l,d,s),p=d,++g,Jt.util.setImmediate(E);h+=y<c?l:l.substr(0,f),++y,m()}m()}});var Hc=Q((pw,Mc)=>{var to=gt();Pt();var Fc=Mc.exports=to.pem=to.pem||{};Fc.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Ji(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Ji(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Ji(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Ji(e.headers[i]);return e.procType&&(r+=`\r
`),r+=to.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Fc.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(e),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:to.util.decode64(o[3])};if(t.push(a),!!o[2]){for(var c=o[2].split(i),f=0;o&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(o=u.match(n),o){for(var d={name:o[1],values:[]},p=o[2].split(","),y=0;y<p.length;++y)d.values.push(Bd(p[y]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Ji(e){for(var t=e.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<t.length;++i,++o)if(o>65&&s!==-1){var a=t[s];a===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+a+t.substr(s+1),o=i-s-1,s=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(s=i);return t}function Bd(e){return e.replace(/^\s+/,"")}});var Wc=Q((dw,$c)=>{var ke=gt();Nr();Pt();var qc=$c.exports=ke.sha256=ke.sha256||{};ke.md.sha256=ke.md.algorithms.sha256=qc;qc.create=function(){zc||Ad();var e=null,t=ke.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return t=ke.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=ke.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),Vc(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ke.util.createBuffer();i.putBytes(t.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Ts.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Vc(h,r,i);var l=ke.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Ts=null,zc=!1,Gc=null;function Ad(){Ts=String.fromCharCode(128),Ts+=ke.util.fillString(String.fromCharCode(0),64),Gc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],zc=!0}function Vc(e,t,r){for(var n,i,o,s,a,c,f,u,h,l,d,p,y,g,m,E=r.length();E>=64;){for(f=0;f<16;++f)t[f]=r.getInt32();for(;f<64;++f)n=t[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[f]=n+t[f-7]+i+t[f-16]|0;for(u=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,y=e.h5,g=e.h6,m=e.h7,f=0;f<64;++f)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=g^p&(y^g),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=m+s+a+Gc[f]+t[f],i=o+c,m=g,g=y,y=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+g|0,e.h7=e.h7+m|0,E-=64}}});var Yc=Q((yw,Zc)=>{var De=gt();Pt();var eo=null;De.util.isNodejs&&!De.options.usePureJavaScript&&!process.versions["node-webkit"]&&(eo=cn());var Cd=Zc.exports=De.prng=De.prng||{};Cd.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(f,u){if(!u)return t.generateSync(f);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,y=De.util.createBuffer();t.key=null,g();function g(m){if(m)return u(m);if(y.length()>=f)return u(null,y.getBytes(f));if(t.generated>1048575&&(t.key=null),t.key===null)return De.util.nextTick(function(){o(g)});var E=h(t.key,t.seed);t.generated+=E.length,y.putBytes(E),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),De.util.setImmediate(g)}},t.generateSync=function(f){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=De.util.createBuffer();p.length()<f;){t.generated>1048575&&(t.key=null),t.key===null&&s();var y=u(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=l(u(t.key,h(t.seed))),t.seed=d(u(t.key,t.seed))}return p.getBytes(f)};function o(f){if(t.pools[0].messageLength>=32)return a(),f();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return f(h);t.collect(l),a(),f()})}function s(){if(t.pools[0].messageLength>=32)return a();var f=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(f)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var f=t.plugin.md.create();f.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(f.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=f.digest().getBytes(),f.start(),f.update(t.keyBytes);var l=f.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function c(f){var u=null,h=De.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(v){return l.getRandomValues(v)});var d=De.util.createBuffer();if(u)for(;d.length()<f;){var p=Math.max(1,Math.min(f-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{u(y);for(var g=0;g<y.length;++g)d.putInt32(y[g])}catch(v){if(!(typeof QuotaExceededError<"u"&&v instanceof QuotaExceededError))throw v}}if(d.length()<f)for(var m,E,b,C=Math.floor(Math.random()*65536);d.length()<f;){E=16807*(C&65535),m=16807*(C>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),C=E&4294967295;for(var g=0;g<3;++g)b=C>>>(g<<3),b^=Math.floor(Math.random()*256),d.putByte(b&255)}return d.getBytes(f)}return eo?(t.seedFile=function(f,u){eo.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(f){return eo.randomBytes(f).toString()}):(t.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},t.seedFileSync=c),t.collect=function(f){for(var u=f.length,h=0;h<u;++h)t.pools[t.pool].update(f.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);t.collect(h)},t.registerWorker=function(f){if(f===self)t.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){f.postMessage({forge:{prng:{err:d,bytes:p}}})})};f.addEventListener("message",u)}},t}});var Xn=Q((gw,Ls)=>{var Vt=gt();_s();Wc();Yc();Pt();(function(){if(Vt.random&&Vt.random.getBytes){Ls.exports=Vt.random;return}(function(e){var t={},r=new Array(4),n=Vt.util.createBuffer();t.formatKey=function(h){var l=Vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Vt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Vt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Vt.md.sha256;function i(){var h=Vt.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var o=i(),s=null,a=Vt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(s=function(h){return c.getRandomValues(h)}),Vt.options.usePureJavaScript||!Vt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}o.collect(f),f=null}e&&(e().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),e().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!Vt.random)Vt.random=o;else for(var u in o)Vt.random[u]=o[u];Vt.random.createInstance=i,Ls.exports=Vt.random})(typeof jQuery<"u"?jQuery:null)})()});var Jc=Q((xw,jc)=>{var ne=gt();Pt();var Rs=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Xc=[1,2,3,5],Id=function(e,t){return e<<t&65535|(e&65535)>>16-t},_d=function(e,t){return(e&65535)>>t|e<<16-t&65535};jc.exports=ne.rc2=ne.rc2||{};ne.rc2.expandKey=function(e,t){typeof e=="string"&&(e=ne.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Rs[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,Rs[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,Rs[r.at(a+1)^r.at(a+o)]);return r};var Qc=function(e,t,r){var n=!1,i=null,o=null,s=null,a,c,f,u,h=[];for(e=ne.rc2.expandKey(e,t),f=0;f<64;f++)h.push(e.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=Id(p[f],Xc[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=_d(p[f],Xc[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var y=[];for(f=0;f<4;f++){var g=i.getInt16Le();s!==null&&(r?g^=s.getInt16Le():s.putInt16Le(g)),y.push(g&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](y);for(f=0;f<4;f++)s!==null&&(r?s.putInt16Le(y[f]):y[f]^=s.getInt16Le()),o.putInt16Le(y[f])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=ne.util.createBuffer(p)),n=!1,i=ne.util.createBuffer(),o=y||new ne.util.createBuffer,s=p,d.output=o},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var g=i.length()===8?8:8-i.length();i.fillWithByte(g,g)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,o,!r);else{var m=o.length(),E=o.at(m-1);E>m?y=!1:o.truncate(E)}return y}},d};ne.rc2.startEncrypting=function(e,t,r){var n=ne.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createEncryptionCipher=function(e,t){return Qc(e,t,!0)};ne.rc2.startDecrypting=function(e,t,r){var n=ne.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createDecryptionCipher=function(e,t){return Qc(e,t,!1)}});var io=Q((mw,cf)=>{var Ns=gt();cf.exports=Ns.jsbn=Ns.jsbn||{};var je,Td=0xdeadbeefcafe,tf=(Td&16777215)==15715070;function I(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Ns.jsbn.BigInteger=I;function ut(){return new I(null)}function Ld(e,t,r,n,i,o){for(;--o>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Rd(e,t,r,n,i,o){for(var s=t&32767,a=t>>15;--o>=0;){var c=this.data[e]&32767,f=this.data[e++]>>15,u=a*c+f*s;c=s*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function ef(e,t,r,n,i,o){for(var s=t&16383,a=t>>14;--o>=0;){var c=this.data[e]&16383,f=this.data[e++]>>14,u=a*c+f*s;c=s*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(I.prototype.am=ef,je=28):tf&&navigator.appName=="Microsoft Internet Explorer"?(I.prototype.am=Rd,je=30):tf&&navigator.appName!="Netscape"?(I.prototype.am=Ld,je=26):(I.prototype.am=ef,je=28);I.prototype.DB=je;I.prototype.DM=(1<<je)-1;I.prototype.DV=1<<je;var ks=52;I.prototype.FV=Math.pow(2,ks);I.prototype.F1=ks-je;I.prototype.F2=2*je-ks;var Nd="0123456789abcdefghijklmnopqrstuvwxyz",ro=new Array,fn,ge;fn="0".charCodeAt(0);for(ge=0;ge<=9;++ge)ro[fn++]=ge;fn="a".charCodeAt(0);for(ge=10;ge<36;++ge)ro[fn++]=ge;fn="A".charCodeAt(0);for(ge=10;ge<36;++ge)ro[fn++]=ge;function rf(e){return Nd.charAt(e)}function nf(e,t){var r=ro[e.charCodeAt(t)];return r??-1}function kd(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Dd(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function dr(e){var t=ut();return t.fromInt(e),t}function Ud(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var s=r==8?e[n]&255:nf(e,n);if(s<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&e[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&I.ZERO.subTo(this,this)}function Pd(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Kd(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=rf(n));s>=0;)a<t?(n=(this.data[s]&(1<<a)-1)<<t-a,n|=this.data[--s]>>(a+=this.DB-t)):(n=this.data[s]>>(a-=t)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=rf(n));return i?o:"0"}function Od(){var e=ut();return I.ZERO.subTo(this,e),e}function Fd(){return this.s<0?this.negate():this}function Md(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function no(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Hd(){return this.t<=0?0:this.DB*(this.t-1)+no(this.data[this.t-1]^this.s&this.DM)}function Vd(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function qd(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function zd(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(e/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)t.data[a]=0;t.data[o]=s,t.t=this.t+o+1,t.s=this.s,t.clamp()}function Gd(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&o)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}function $d(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function Wd(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&I.ZERO.subTo(t,t)}function Zd(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Yd(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ut());var o=ut(),s=this.s,a=e.s,c=this.DB-no(n.data[n.t-1]);c>0?(n.lShiftTo(c,o),i.lShiftTo(c,r)):(n.copyTo(o),i.copyTo(r));var f=o.t,u=o.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,g=y-f,m=t??ut();for(o.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),I.ONE.dlShiftTo(f,m),m.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--g>=0;){var E=r.data[--y]==u?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=o.am(0,E,r,g,0,f))<E)for(o.dlShiftTo(g,m),r.subTo(m,r);r.data[y]<--E;)r.subTo(m,r)}t!=null&&(r.drShiftTo(f,t),s!=a&&I.ZERO.subTo(t,t)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),s<0&&I.ZERO.subTo(r,r)}}}function Xd(e){var t=ut();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(I.ZERO)>0&&e.subTo(t,t),t}function kr(e){this.m=e}function Qd(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function jd(e){return e}function Jd(e){e.divRemTo(this.m,null,e)}function ty(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function ey(e,t){e.squareTo(t),this.reduce(t)}kr.prototype.convert=Qd;kr.prototype.revert=jd;kr.prototype.reduce=Jd;kr.prototype.mulTo=ty;kr.prototype.sqrTo=ey;function ry(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Dr(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function ny(e){var t=ut();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(I.ZERO)>0&&this.m.subTo(t,t),t}function iy(e){var t=ut();return e.copyTo(t),this.reduce(t),t}function oy(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function sy(e,t){e.squareTo(t),this.reduce(t)}function ay(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Dr.prototype.convert=ny;Dr.prototype.revert=iy;Dr.prototype.reduce=oy;Dr.prototype.mulTo=ay;Dr.prototype.sqrTo=sy;function cy(){return(this.t>0?this.data[0]&1:this.s)==0}function fy(e,t){if(e>4294967295||e<1)return I.ONE;var r=ut(),n=ut(),i=t.convert(this),o=no(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var s=r;r=n,n=s}return t.revert(r)}function uy(e,t){var r;return e<256||t.isEven()?r=new kr(t):r=new Dr(t),this.exp(e,r)}I.prototype.copyTo=kd;I.prototype.fromInt=Dd;I.prototype.fromString=Ud;I.prototype.clamp=Pd;I.prototype.dlShiftTo=Vd;I.prototype.drShiftTo=qd;I.prototype.lShiftTo=zd;I.prototype.rShiftTo=Gd;I.prototype.subTo=$d;I.prototype.multiplyTo=Wd;I.prototype.squareTo=Zd;I.prototype.divRemTo=Yd;I.prototype.invDigit=ry;I.prototype.isEven=cy;I.prototype.exp=fy;I.prototype.toString=Kd;I.prototype.negate=Od;I.prototype.abs=Fd;I.prototype.compareTo=Md;I.prototype.bitLength=Hd;I.prototype.mod=Xd;I.prototype.modPowInt=uy;I.ZERO=dr(0);I.ONE=dr(1);function hy(){var e=ut();return this.copyTo(e),e}function ly(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function py(){return this.t==0?this.s:this.data[0]<<24>>24}function dy(){return this.t==0?this.s:this.data[0]<<16>>16}function yy(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function gy(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function xy(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=dr(r),i=ut(),o=ut(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(e)+s}function my(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,s=0,a=0;a<e.length;++a){var c=nf(e,a);if(c<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=t*s+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&I.ZERO.subTo(this,this)}function by(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(I.ONE.shiftLeft(e-1),Ds,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(I.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function wy(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function vy(e){return this.compareTo(e)==0}function Ey(e){return this.compareTo(e)<0?this:e}function Sy(e){return this.compareTo(e)>0?this:e}function By(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Ay(e,t){return e&t}function Cy(e){var t=ut();return this.bitwiseTo(e,Ay,t),t}function Ds(e,t){return e|t}function Iy(e){var t=ut();return this.bitwiseTo(e,Ds,t),t}function of(e,t){return e^t}function _y(e){var t=ut();return this.bitwiseTo(e,of,t),t}function sf(e,t){return e&~t}function Ty(e){var t=ut();return this.bitwiseTo(e,sf,t),t}function Ly(){for(var e=ut(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Ry(e){var t=ut();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Ny(e){var t=ut();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ky(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function Dy(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ky(this.data[e]);return this.s<0?this.t*this.DB:-1}function Uy(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Py(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Uy(this.data[r]^t);return e}function Ky(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Oy(e,t){var r=I.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Fy(e){return this.changeBit(e,Ds)}function My(e){return this.changeBit(e,sf)}function Hy(e){return this.changeBit(e,of)}function Vy(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function qy(e){var t=ut();return this.addTo(e,t),t}function zy(e){var t=ut();return this.subTo(e,t),t}function Gy(e){var t=ut();return this.multiplyTo(e,t),t}function $y(e){var t=ut();return this.divRemTo(e,t,null),t}function Wy(e){var t=ut();return this.divRemTo(e,null,t),t}function Zy(e){var t=ut(),r=ut();return this.divRemTo(e,t,r),new Array(t,r)}function Yy(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Xy(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Qn(){}function af(e){return e}function Qy(e,t,r){e.multiplyTo(t,r)}function jy(e,t){e.squareTo(t)}Qn.prototype.convert=af;Qn.prototype.revert=af;Qn.prototype.mulTo=Qy;Qn.prototype.sqrTo=jy;function Jy(e){return this.exp(e,new Qn)}function t1(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function e1(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function un(e){this.r2=ut(),this.q3=ut(),I.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function r1(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ut();return e.copyTo(t),this.reduce(t),t}function n1(e){return e}function i1(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function o1(e,t){e.squareTo(t),this.reduce(t)}function s1(e,t,r){e.multiplyTo(t,r),this.reduce(r)}un.prototype.convert=r1;un.prototype.revert=n1;un.prototype.reduce=i1;un.prototype.mulTo=s1;un.prototype.sqrTo=o1;function a1(e,t){var r=e.bitLength(),n,i=dr(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new kr(t):t.isEven()?o=new un(t):o=new Dr(t);var s=new Array,a=3,c=n-1,f=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=ut();for(o.sqrTo(s[1],u);a<=f;)s[a]=ut(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=e.t-1,l,d=!0,p=ut(),y;for(r=no(e.data[h])-1;h>=0;){for(r>=c?l=e.data[h]>>r-c&f:(l=(e.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=e.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;a>1;)o.sqrTo(i,p),o.sqrTo(p,i),a-=2;a>0?o.sqrTo(i,p):(y=i,i=p,p=y),o.mulTo(p,s[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)o.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function c1(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function f1(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function u1(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return I.ZERO;for(var r=e.clone(),n=this.clone(),i=dr(1),o=dr(0),s=dr(0),a=dr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),t&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(I.ONE)!=0)return I.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var Be=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],h1=(1<<26)/Be[Be.length-1];function l1(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=Be[Be.length-1]){for(t=0;t<Be.length;++t)if(r.data[0]==Be[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Be.length;){for(var n=Be[t],i=t+1;i<Be.length&&n<h1;)n*=Be[i++];for(n=r.modInt(n);t<i;)if(n%Be[t++]==0)return!1}return r.millerRabin(e)}function p1(e){var t=this.subtract(I.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=d1(),o,s=0;s<e;++s){do o=new I(this.bitLength(),i);while(o.compareTo(I.ONE)<=0||o.compareTo(t)>=0);var a=o.modPow(n,this);if(a.compareTo(I.ONE)!=0&&a.compareTo(t)!=0){for(var c=1;c++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(I.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function d1(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}I.prototype.chunkSize=yy;I.prototype.toRadix=xy;I.prototype.fromRadix=my;I.prototype.fromNumber=by;I.prototype.bitwiseTo=By;I.prototype.changeBit=Oy;I.prototype.addTo=Vy;I.prototype.dMultiply=Yy;I.prototype.dAddOffset=Xy;I.prototype.multiplyLowerTo=t1;I.prototype.multiplyUpperTo=e1;I.prototype.modInt=f1;I.prototype.millerRabin=p1;I.prototype.clone=hy;I.prototype.intValue=ly;I.prototype.byteValue=py;I.prototype.shortValue=dy;I.prototype.signum=gy;I.prototype.toByteArray=wy;I.prototype.equals=vy;I.prototype.min=Ey;I.prototype.max=Sy;I.prototype.and=Cy;I.prototype.or=Iy;I.prototype.xor=_y;I.prototype.andNot=Ty;I.prototype.not=Ly;I.prototype.shiftLeft=Ry;I.prototype.shiftRight=Ny;I.prototype.getLowestSetBit=Dy;I.prototype.bitCount=Py;I.prototype.testBit=Ky;I.prototype.setBit=Fy;I.prototype.clearBit=My;I.prototype.flipBit=Hy;I.prototype.add=qy;I.prototype.subtract=zy;I.prototype.multiply=Gy;I.prototype.divide=$y;I.prototype.remainder=Wy;I.prototype.divideAndRemainder=Zy;I.prototype.modPow=a1;I.prototype.modInverse=u1;I.prototype.pow=Jy;I.prototype.gcd=c1;I.prototype.isProbablePrime=l1});var pf=Q((bw,lf)=>{var Ue=gt();Nr();Pt();var uf=lf.exports=Ue.sha1=Ue.sha1||{};Ue.md.sha1=Ue.md.algorithms.sha1=uf;uf.create=function(){hf||y1();var e=null,t=Ue.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return t=Ue.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=Ue.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),ff(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Ue.util.createBuffer();i.putBytes(t.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Us.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ff(h,r,i);var l=Ue.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Us=null,hf=!1;function y1(){Us=String.fromCharCode(128),Us+=Ue.util.fillString(String.fromCharCode(0),64),hf=!0}function ff(e,t,r){for(var n,i,o,s,a,c,f,u,h=r.length();h>=64;){for(i=e.h0,o=e.h1,s=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=o&s|a&(o^s),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,h-=64}}});var gf=Q((ww,yf)=>{var Pe=gt();Pt();Xn();pf();var df=yf.exports=Pe.pkcs1=Pe.pkcs1||{};df.encode_rsa_oaep=function(e,t,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=Pe.md.sha1.create(),s||(s=o);var a=Math.ceil(e.n.bitLength()/8),c=a-2*o.digestLength-2;if(t.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=t.length,f.maxLength=c,f}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",l=c-t.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=Pe.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=o.digestLength,f}var y=oo(i,a-o.digestLength-1,s),g=Pe.util.xorBytes(p,y,p.length),m=oo(g,o.digestLength,s),E=Pe.util.xorBytes(i,m,i.length);return"\0"+E+g};df.decode_rsa_oaep=function(e,t,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=t.length,g.expectedLength=s,g}if(i===void 0?i=Pe.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=t.charAt(0),f=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=oo(u,i.digestLength,o),l=Pe.util.xorBytes(f,h,f.length),d=oo(l,s-i.digestLength-1,o),p=Pe.util.xorBytes(u,d,u.length),y=p.substring(0,i.digestLength),g=c!=="\0",m=0;m<i.digestLength;++m)g|=a.charAt(m)!==y.charAt(m);for(var E=1,b=i.digestLength,C=i.digestLength;C<p.length;C++){var v=p.charCodeAt(C),A=v&1^1,P=E?65534:0;g|=v&P,E=E&A,b+=E}if(g||p.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(b+1)};function oo(e,t,r){r||(r=Pe.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(e+s),n+=r.digest().getBytes()}return n.substring(0,t)}});var xf=Q((vw,Ps)=>{var yr=gt();Pt();io();Xn();(function(){if(yr.prime){Ps.exports=yr.prime;return}var e=Ps.exports=yr.prime=yr.prime||{},t=yr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||yr.random,g={nextBytes:function(m){for(var E=y.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(p.name==="PRIMEINC")return o(h,g,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function o(h,l,d,p){return"workers"in d?c(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var y=f(h,l),g=0,m=u(y.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var E=10;"maxBlockTime"in d&&(E=d.maxBlockTime),a(y,h,l,g,m,E,p)}function a(h,l,d,p,y,g,m){var E=+new Date;do{if(h.bitLength()>l&&(h=f(l,d)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[p++%8],0)}while(g<0||+new Date-E<g);yr.util.setImmediate(function(){a(h,l,d,p,y,g,m)})}function c(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var y=f(h,l),g=d.workers,m=d.workLoad||100,E=m*30/8,b=d.workerScript||"forge/prime.worker.js";if(g===-1)return yr.util.estimateCores(function(v,A){v&&(A=2),g=A-1,C()});C();function C(){g=Math.max(1,g);for(var v=[],A=0;A<g;++A)v[A]=new Worker(b);for(var P=g,A=0;A<g;++A)v[A].addEventListener("message",R);var k=!1;function R($){if(!k){--P;var V=$.data;if(V.found){for(var H=0;H<v.length;++H)v[H].terminate();return k=!0,p(null,new t(V.prime,16))}y.bitLength()>h&&(y=f(h,l));var z=y.toString(16);$.target.postMessage({hex:z,workLoad:m}),y.dAddOffset(E,0)}}}}function f(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var ao=Q((Ew,Bf)=>{var Z=gt();Yn();io();$i();gf();xf();Xn();Pt();typeof st>"u"&&(st=Z.jsbn.BigInteger);var st,Ks=Z.util.isNodejs?cn():null,w=Z.asn1,xe=Z.util;Z.pki=Z.pki||{};Bf.exports=Z.pki.rsa=Z.rsa=Z.rsa||{};var X=Z.pki,g1=[6,4,2,4,2,4,6,2],x1={name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},m1={name:"RSAPrivateKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},b1={name:"RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},w1=Z.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},v1={name:"DigestInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:w.Class.UNIVERSAL,type:w.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},E1=function(e){var t;if(e.algorithm in X.oids)t=X.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=w.oidToDer(t).getBytes(),i=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),o=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);o.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,n)),o.value.push(w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,""));var s=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(o),i.value.push(s),w.toDer(i).getBytes()},Ef=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(st.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(st.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new st(Z.util.bytesToHex(Z.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(st.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(o)<0;)i=i.add(t.p);var s=i.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return s=s.multiply(n.modInverse(t.n)).mod(t.n),s};X.rsa.encrypt=function(e,t,r){var n=r,i,o=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Sf(e,t,r)):(i=Z.util.createBuffer(),i.putBytes(e));for(var s=new st(i.toHex(),16),a=Ef(s,t,n),c=a.toString(16),f=Z.util.createBuffer(),u=o-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Z.util.hexToBytes(c)),f.getBytes()};X.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=i,o}var s=new st(Z.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Ef(s,t,r),c=a.toString(16),f=Z.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Z.util.hexToBytes(c)),n!==!1?so(f.getBytes(),t,r):f.getBytes()};X.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||Z.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:e,rng:i,eInt:t||65537,e:new st(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};X.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new st(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},o=+new Date,s,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,f=c-1;e.pqState===0?(e.num=new st(c,e.rng),e.num.testBit(f)||e.num.bitwiseTo(st.ONE.shiftLeft(f),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(B1(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(g1[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(st.ONE),e.q1=e.q.subtract(st.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(st.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:X.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:X.rsa.setPublicKey(e.n,e.e)}}s=+new Date,a+=s-o,o=s}return e.keys!==null};X.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!Z.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(mf("generateKeyPair"))return Ks.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:X.privateKeyFromPem(f),publicKey:X.publicKeyFromPem(c)})});if(bf("generateKey")&&bf("exportKey"))return xe.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:vf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return xe.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=X.privateKeyFromAsn1(w.fromDer(Z.util.createBuffer(a)));n(null,{privateKey:c,publicKey:X.setRsaPublicKey(c.n,c.e)})}});if(wf("generateKey")&&wf("exportKey")){var i=xe.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:vf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=xe.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=X.privateKeyFromAsn1(w.fromDer(Z.util.createBuffer(h)));n(null,{privateKey:l,publicKey:X.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(mf("generateKeyPairSync")){var o=Ks.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:X.privateKeyFromPem(o.privateKey),publicKey:X.publicKeyFromPem(o.publicKey)}}}var s=X.rsa.createKeyPairGenerationState(e,t,r);if(!n)return X.rsa.stepKeyPairGenerationState(s,0),s.keys;S1(s,r,n)};X.setRsaPublicKey=X.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return Sf(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return Z.pkcs1.encode_rsa_oaep(c,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return X.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(c,f){f=so(f,r,!0);var u=w.fromDer(f,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!w.validate(u,v1,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=w.derToOid(h.algorithmIdentifier);if(!(p===Z.oids.md2||p===Z.oids.md5||p===Z.oids.sha1||p===Z.oids.sha224||p===Z.oids.sha256||p===Z.oids.sha384||p===Z.oids.sha512||p===Z.oids["sha512-224"]||p===Z.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===Z.oids.md2||p===Z.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(c,f){return f=so(f,r,!0),c===f}});var a=X.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};X.setRsaPrivateKey=X.rsa.setPrivateKey=function(e,t,r,n,i,o,s,a){var c={n:e,e:t,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=X.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:so};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return Z.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:E1},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return X.rsa.encrypt(l,c,h)},c};X.wrapRsaPrivateKey=function(e){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(X.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,w.toDer(e).getBytes())])};X.privateKeyFromAsn1=function(e){var t={},r=[];if(w.validate(e,x1,t,r)&&(e=w.fromDer(Z.util.createBuffer(t.privateKey))),t={},r=[],!w.validate(e,m1,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,c,f,u,h;return i=Z.util.createBuffer(t.privateKeyModulus).toHex(),o=Z.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=Z.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=Z.util.createBuffer(t.privateKeyPrime1).toHex(),c=Z.util.createBuffer(t.privateKeyPrime2).toHex(),f=Z.util.createBuffer(t.privateKeyExponent1).toHex(),u=Z.util.createBuffer(t.privateKeyExponent2).toHex(),h=Z.util.createBuffer(t.privateKeyCoefficient).toHex(),X.setRsaPrivateKey(new st(i,16),new st(o,16),new st(s,16),new st(a,16),new st(c,16),new st(f,16),new st(u,16),new st(h,16))};X.privateKeyToAsn1=X.privateKeyToRSAPrivateKey=function(e){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.e)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.d)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.p)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.q)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.dP)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.dQ)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.qInv))])};X.publicKeyFromAsn1=function(e){var t={},r=[];if(w.validate(e,w1,t,r)){var n=w.derToOid(t.publicKeyOid);if(n!==X.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!w.validate(e,b1,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=Z.util.createBuffer(t.publicKeyModulus).toHex(),s=Z.util.createBuffer(t.publicKeyExponent).toHex();return X.setRsaPublicKey(new st(o,16),new st(s,16))};X.publicKeyToAsn1=X.publicKeyToSubjectPublicKeyInfo=function(e){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(X.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,[X.publicKeyToRSAPublicKey(e)])])};X.publicKeyToRSAPublicKey=function(e){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Ke(e.e))])};function Sf(e,t,r){var n=Z.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<s;++c)n.putByte(a)}else for(;s>0;){for(var f=0,u=Z.random.getBytes(s),c=0;c<s;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);s=f}return n.putByte(0),n.putBytes(e),n}function so(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),o=Z.util.createBuffer(e),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++c}else if(a===2)for(c=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++c}var u=o.getByte();if(u!==0||c!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function S1(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){o(e.pBits,function(a,c){if(a)return r(a);if(e.p=c,e.q!==null)return s(a,e.q);o(e.qBits,s)})}function o(a,c){Z.prime.generateProbablePrime(a,n,c)}function s(a,c){if(a)return r(a);if(e.q=c,e.p.compareTo(e.q)<0){var f=e.p;e.p=e.q,e.q=f}if(e.p.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)!==0){e.p=null,i();return}if(e.q.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)!==0){e.q=null,o(e.qBits,s);return}if(e.p1=e.p.subtract(st.ONE),e.q1=e.q.subtract(st.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(st.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,o(e.qBits,s);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:X.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:X.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Ke(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=Z.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function B1(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function mf(e){return Z.util.isNodejs&&typeof Ks[e]=="function"}function bf(e){return typeof xe.globalScope<"u"&&typeof xe.globalScope.crypto=="object"&&typeof xe.globalScope.crypto.subtle=="object"&&typeof xe.globalScope.crypto.subtle[e]=="function"}function wf(e){return typeof xe.globalScope<"u"&&typeof xe.globalScope.msCrypto=="object"&&typeof xe.globalScope.msCrypto.subtle=="object"&&typeof xe.globalScope.msCrypto.subtle[e]=="function"}function vf(e){for(var t=Z.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Lf=Q((Sw,Tf)=>{var K=gt();_s();Yn();kc();Nr();$i();Oc();Hc();Xn();Jc();ao();Pt();typeof Af>"u"&&(Af=K.jsbn.BigInteger);var Af,B=K.asn1,tt=K.pki=K.pki||{};Tf.exports=tt.pbe=K.pbe=K.pbe||{};var Ur=tt.oids,A1={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},C1={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},I1={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};tt.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=K.random.getBytesSync(r.saltSize),i=r.count,o=B.integerToDer(i),s,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":s=16,f=16,u=Ur["aes128-CBC"],h=K.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,u=Ur["aes192-CBC"],h=K.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,u=Ur["aes256-CBC"],h=K.aes.createEncryptionCipher;break;case"des":s=8,f=8,u=Ur.desCBC,h=K.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=_f(d),y=K.pkcs5.pbkdf2(t,n,i,s,p),g=K.random.getBytesSync(f),m=h(y);m.start(g),m.update(B.toDer(e)),m.finish(),c=m.output.getBytes();var E=_1(n,o,s,d);a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ur.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ur.pkcs5PBKDF2).getBytes()),E]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(u).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){s=24;var b=new K.util.ByteBuffer(n),y=tt.pbe.generatePkcs12Key(t,b,1,i,s),g=tt.pbe.generatePkcs12Key(t,b,2,i,s),m=K.des.createEncryptionCipher(y);m.start(g),m.update(B.toDer(e)),m.finish(),c=m.output.getBytes(),a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ur["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,o.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[a,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,c)]);return C};tt.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!B.validate(e,A1,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=B.derToOid(n.encryptionOid),a=tt.pbe.getCipher(s,n.encryptionParams,t),c=K.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=B.fromDer(a.output)),r};tt.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(e).getBytes()};return K.pem.encode(r,{maxline:t})};tt.encryptedPrivateKeyFromPem=function(e){var t=K.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(t.body)};tt.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=tt.wrapRsaPrivateKey(tt.privateKeyToAsn1(e));return n=tt.encryptPrivateKeyInfo(n,t,r),tt.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=K.pbe.opensslDeriveBytes(t,o.substr(0,8),s),u=a(f);u.start(o),u.update(B.toDer(tt.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:K.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return K.pem.encode(h)};tt.decryptRsaPrivateKey=function(e,t){var r=null,n=K.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=K.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=K.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=K.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=K.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=K.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return K.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return K.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return K.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=K.util.hexToBytes(n.dekInfo.parameters),c=K.pbe.opensslDeriveBytes(t,a.substr(0,8),o),f=s(c);if(f.start(a),f.update(K.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=tt.decryptPrivateKeyInfo(B.fromDer(r),t):r=B.fromDer(r),r!==null&&(r=tt.privateKeyFromAsn1(r)),r};tt.pbe.generatePkcs12Key=function(e,t,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in K.md))throw new Error('"sha1" hash algorithm unavailable.');o=K.md.sha1.create()}var c=o.digestLength,f=o.blockLength,u=new K.util.ByteBuffer,h=new K.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=t.length(),p=new K.util.ByteBuffer;p.fillWithByte(r,f);var y=f*Math.ceil(d/f),g=new K.util.ByteBuffer;for(a=0;a<y;a++)g.putByte(t.at(a%d));var m=f*Math.ceil(l/f),E=new K.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%l));var b=g;b.putBuffer(E);for(var C=Math.ceil(i/c),v=1;v<=C;v++){var A=new K.util.ByteBuffer;A.putBytes(p.bytes()),A.putBytes(b.bytes());for(var P=0;P<n;P++)o.start(),o.update(A.getBytes()),A=o.digest();var k=new K.util.ByteBuffer;for(a=0;a<f;a++)k.putByte(A.at(a%c));var R=Math.ceil(d/f)+Math.ceil(l/f),$=new K.util.ByteBuffer;for(s=0;s<R;s++){var V=new K.util.ByteBuffer(b.getBytes(f)),H=511;for(a=k.length()-1;a>=0;a--)H=H>>8,H+=k.at(a)+V.at(a),V.setAt(a,H&255);$.putBuffer(V)}b=$,u.putBuffer(A)}return u.truncate(u.length()-i),u};tt.pbe.getCipher=function(e,t,r){switch(e){case tt.oids.pkcs5PBES2:return tt.pbe.getCipherForPBES2(e,t,r);case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:return tt.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};tt.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!B.validate(t,C1,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(e=B.derToOid(n.kdfOid),e!==tt.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=e,o.supportedOids=["pkcs5PBKDF2"],o}if(e=B.derToOid(n.encOid),e!==tt.oids["aes128-CBC"]&&e!==tt.oids["aes192-CBC"]&&e!==tt.oids["aes256-CBC"]&&e!==tt.oids["des-EDE3-CBC"]&&e!==tt.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=e,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=K.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(tt.oids[e]){case"aes128-CBC":c=16,f=K.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=K.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=K.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=K.des.createDecryptionCipher;break;case"desCBC":c=8,f=K.des.createDecryptionCipher;break}var u=If(n.prfOid),h=K.pkcs5.pbkdf2(r,s,a,c,u),l=n.encIv,d=f(h);return d.start(l),d};tt.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!B.validate(t,I1,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=K.util.createBuffer(n.salt),a=K.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(e){case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=K.des.startDecrypting;break;case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(y,g){var m=K.rc2.createDecryptionCipher(y,40);return m.start(g,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=e,o}var h=If(n.prfOid),l=tt.pbe.generatePkcs12Key(r,s,1,a,c,h);h.start();var d=tt.pbe.generatePkcs12Key(r,s,2,a,f,h);return u(l,d)};tt.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in K.md))throw new Error('"md5" hash algorithm unavailable.');n=K.md.md5.create()}t===null&&(t="");for(var i=[Cf(n,e+t)],o=16,s=1;o<r;++s,o+=16)i.push(Cf(n,i[s-1]+e+t));return i.join("").substr(0,r)};function Cf(e,t){return e.start().update(t).digest().getBytes()}function If(e){var t;if(!e)t="hmacWithSHA1";else if(t=tt.oids[B.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return _f(t)}function _f(e){var t=K.md;switch(e){case"hmacWithSHA224":t=K.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function _1(e,t,r,n){var i=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,e),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,K.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(tt.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),i}});var pu=Q((wv,lu)=>{"use strict";lu.exports=jg;function jg(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(u){if(o)if(o=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{e.apply(t||null,r)}catch(f){o&&(o=!1,c(f))}})}});var xu=Q(gu=>{"use strict";var go=gu;go.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var wn=new Array(64),yu=new Array(123);for(Ae=0;Ae<64;)yu[wn[Ae]=Ae<26?Ae+65:Ae<52?Ae+71:Ae<62?Ae-4:Ae-59|43]=Ae++;var Ae;go.encode=function(t,r,n){for(var i=null,o=[],s=0,a=0,c;r<n;){var f=t[r++];switch(a){case 0:o[s++]=wn[f>>2],c=(f&3)<<4,a=1;break;case 1:o[s++]=wn[c|f>>4],c=(f&15)<<2,a=2;break;case 2:o[s++]=wn[c|f>>6],o[s++]=wn[f&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=wn[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var du="invalid encoding";go.decode=function(t,r,n){for(var i=n,o=0,s,a=0;a<t.length;){var c=t.charCodeAt(a++);if(c===61&&o>1)break;if((c=yu[c])===void 0)throw Error(du);switch(o){case 0:s=c,o=1;break;case 1:r[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:r[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:r[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(du);return n-i};go.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var bu=Q((Ev,mu)=>{"use strict";mu.exports=xo;function xo(){this._listeners={}}xo.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};xo.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};xo.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Cu=Q((Sv,Au)=>{"use strict";Au.exports=wu(wu);function wu(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(c,f,u){t[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function o(c,f,u){t[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],t[0]}function a(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],t[0]}e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|f)>>>0,o,s)}}e.writeFloatLE=t.bind(null,vu),e.writeFloatBE=t.bind(null,Eu);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,f=s&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}e.readFloatLE=r.bind(null,Su),e.readFloatBE=r.bind(null,Bu)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(c,f,u){t[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function o(c,f,u){t[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],t[0]}function a(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],t[0]}e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(n,i,o,s,a,c){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((f<<31|2146435072)>>>0,a,c+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,c+i),n((f<<31|u/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,a,c+i),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+o)}}}e.writeDoubleLE=t.bind(null,vu,0,4),e.writeDoubleBE=t.bind(null,Eu,4,0);function r(n,i,o,s,a){var c=n(s,a+i),f=n(s,a+o),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,Su,0,4),e.readDoubleBE=r.bind(null,Bu,4,0)}(),e}function vu(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Eu(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Su(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Bu(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Iu=Q((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Tu=Q(_u=>{"use strict";var ya=_u;ya.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ya.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,c;r<n;)c=t[r++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|t[r++]&63:c>239&&c<365?(c=((c&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(t[r++]&63)<<6|t[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};ya.write=function(t,r,n){for(var i=n,o,s,a=0;a<t.length;++a)o=t.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=t.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var Ru=Q((Av,Lu)=>{"use strict";Lu.exports=Jg;function Jg(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return e(c);s+c>n&&(o=e(n),s=0);var f=t.call(o,s,s+=c);return s&7&&(s=(s|7)+1),f}}});var ku=Q((Cv,Nu)=>{"use strict";Nu.exports=zt;var si=Or();function zt(e,t){this.lo=e>>>0,this.hi=t>>>0}var Kr=zt.zero=new zt(0,0);Kr.toNumber=function(){return 0};Kr.zzEncode=Kr.zzDecode=function(){return this};Kr.length=function(){return 1};var t2=zt.zeroHash="\0\0\0\0\0\0\0\0";zt.fromNumber=function(t){if(t===0)return Kr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new zt(n,i)};zt.from=function(t){if(typeof t=="number")return zt.fromNumber(t);if(si.isString(t))if(si.Long)t=si.Long.fromString(t);else return zt.fromNumber(parseInt(t,10));return t.low||t.high?new zt(t.low>>>0,t.high>>>0):Kr};zt.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};zt.prototype.toLong=function(t){return si.Long?new si.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Br=String.prototype.charCodeAt;zt.fromHash=function(t){return t===t2?Kr:new zt((Br.call(t,0)|Br.call(t,1)<<8|Br.call(t,2)<<16|Br.call(t,3)<<24)>>>0,(Br.call(t,4)|Br.call(t,5)<<8|Br.call(t,6)<<16|Br.call(t,7)<<24)>>>0)};zt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};zt.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};zt.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};zt.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Or=Q(ga=>{"use strict";var G=ga;G.asPromise=pu();G.base64=xu();G.EventEmitter=bu();G.float=Cu();G.inquire=Iu();G.utf8=Tu();G.pool=Ru();G.LongBits=ku();G.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);G.global=G.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ga;G.emptyArray=Object.freeze?Object.freeze([]):[];G.emptyObject=Object.freeze?Object.freeze({}):{};G.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};G.isString=function(t){return typeof t=="string"||t instanceof String};G.isObject=function(t){return t&&typeof t=="object"};G.isset=G.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};G.Buffer=function(){try{var e=G.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();G._Buffer_from=null;G._Buffer_allocUnsafe=null;G.newBuffer=function(t){return typeof t=="number"?G.Buffer?G._Buffer_allocUnsafe(t):new G.Array(t):G.Buffer?G._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};G.Array=typeof Uint8Array<"u"?Uint8Array:Array;G.Long=G.global.dcodeIO&&G.global.dcodeIO.Long||G.global.Long||G.inquire("long");G.key2Re=/^true|false|0|1$/;G.key32Re=/^-?(?:0|[1-9][0-9]*)$/;G.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;G.longToHash=function(t){return t?G.LongBits.from(t).toHash():G.LongBits.zeroHash};G.longFromHash=function(t,r){var n=G.LongBits.fromHash(t);return G.Long?G.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Du(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}G.merge=Du;G.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Uu(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Du(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}G.newError=Uu;G.ProtocolError=Uu("ProtocolError");G.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};G.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};G.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};G._configure=function(){var e=G.Buffer;if(!e){G._Buffer_from=G._Buffer_allocUnsafe=null;return}G._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},G._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var ba=Q((_v,Mu)=>{"use strict";Mu.exports=Ut;var Me=Or(),ma,Ou=Me.LongBits,e2=Me.utf8;function Ce(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Ut(e){this.buf=e,this.pos=0,this.len=e.length}var Pu=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Ut(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Ut(t);throw Error("illegal buffer")},Fu=function(){return Me.Buffer?function(r){return(Ut.create=function(i){return Me.Buffer.isBuffer(i)?new ma(i):Pu(i)})(r)}:Pu};Ut.create=Fu();Ut.prototype._slice=Me.Array.prototype.subarray||Me.Array.prototype.slice;Ut.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Ce(this,10);return t}}();Ut.prototype.int32=function(){return this.uint32()|0};Ut.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function xa(){var e=new Ou(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Ce(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Ce(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Ut.prototype.bool=function(){return this.uint32()!==0};function mo(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Ut.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ce(this,4);return mo(this.buf,this.pos+=4)};Ut.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ce(this,4);return mo(this.buf,this.pos+=4)|0};function Ku(){if(this.pos+8>this.len)throw Ce(this,8);return new Ou(mo(this.buf,this.pos+=4),mo(this.buf,this.pos+=4))}Ut.prototype.float=function(){if(this.pos+4>this.len)throw Ce(this,4);var t=Me.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Ut.prototype.double=function(){if(this.pos+8>this.len)throw Ce(this,4);var t=Me.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Ut.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Ce(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Ut.prototype.string=function(){var t=this.bytes();return e2.read(t,0,t.length)};Ut.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Ce(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Ce(this);while(this.buf[this.pos++]&128);return this};Ut.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Ut._configure=function(e){ma=e,Ut.create=Fu(),ma._configure();var t=Me.Long?"toLong":"toNumber";Me.merge(Ut.prototype,{int64:function(){return xa.call(this)[t](!1)},uint64:function(){return xa.call(this)[t](!0)},sint64:function(){return xa.call(this).zzDecode()[t](!1)},fixed64:function(){return Ku.call(this)[t](!0)},sfixed64:function(){return Ku.call(this)[t](!1)}})}});var zu=Q((Tv,qu)=>{"use strict";qu.exports=Fr;var Vu=ba();(Fr.prototype=Object.create(Vu.prototype)).constructor=Fr;var Hu=Or();function Fr(e){Vu.call(this,e)}Fr._configure=function(){Hu.Buffer&&(Fr.prototype._slice=Hu.Buffer.prototype.slice)};Fr.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Fr._configure()});var Ca=Q((Lv,Zu)=>{"use strict";Zu.exports=ht;var me=Or(),wa,bo=me.LongBits,Gu=me.base64,$u=me.utf8;function ai(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Ea(){}function r2(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function ht(){this.len=0,this.head=new ai(Ea,0,0),this.tail=this.head,this.states=null}var Wu=function(){return me.Buffer?function(){return(ht.create=function(){return new wa})()}:function(){return new ht}};ht.create=Wu();ht.alloc=function(t){return new me.Array(t)};me.Array!==Array&&(ht.alloc=me.pool(ht.alloc,me.Array.prototype.subarray));ht.prototype._push=function(t,r,n){return this.tail=this.tail.next=new ai(t,r,n),this.len+=r,this};function Sa(e,t,r){t[r]=e&255}function n2(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Ba(e,t){this.len=e,this.next=void 0,this.val=t}Ba.prototype=Object.create(ai.prototype);Ba.prototype.fn=n2;ht.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Ba((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};ht.prototype.int32=function(t){return t<0?this._push(Aa,10,bo.fromNumber(t)):this.uint32(t)};ht.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Aa(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}ht.prototype.uint64=function(t){var r=bo.from(t);return this._push(Aa,r.length(),r)};ht.prototype.int64=ht.prototype.uint64;ht.prototype.sint64=function(t){var r=bo.from(t).zzEncode();return this._push(Aa,r.length(),r)};ht.prototype.bool=function(t){return this._push(Sa,1,t?1:0)};function va(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}ht.prototype.fixed32=function(t){return this._push(va,4,t>>>0)};ht.prototype.sfixed32=ht.prototype.fixed32;ht.prototype.fixed64=function(t){var r=bo.from(t);return this._push(va,4,r.lo)._push(va,4,r.hi)};ht.prototype.sfixed64=ht.prototype.fixed64;ht.prototype.float=function(t){return this._push(me.float.writeFloatLE,4,t)};ht.prototype.double=function(t){return this._push(me.float.writeDoubleLE,8,t)};var i2=me.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};ht.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Sa,1,0);if(me.isString(t)){var n=ht.alloc(r=Gu.length(t));Gu.decode(t,n,0),t=n}return this.uint32(r)._push(i2,r,t)};ht.prototype.string=function(t){var r=$u.length(t);return r?this.uint32(r)._push($u.write,r,t):this._push(Sa,1,0)};ht.prototype.fork=function(){return this.states=new r2(this),this.head=this.tail=new ai(Ea,0,0),this.len=0,this};ht.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ai(Ea,0,0),this.len=0),this};ht.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};ht.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};ht._configure=function(e){wa=e,ht.create=Wu(),wa._configure()}});var Qu=Q((Rv,Xu)=>{"use strict";Xu.exports=He;var Yu=Ca();(He.prototype=Object.create(Yu.prototype)).constructor=He;var Ar=Or();function He(){Yu.call(this)}He._configure=function(){He.alloc=Ar._Buffer_allocUnsafe,He.writeBytesBuffer=Ar.Buffer&&Ar.Buffer.prototype instanceof Uint8Array&&Ar.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};He.prototype.bytes=function(t){Ar.isString(t)&&(t=Ar._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(He.writeBytesBuffer,r,t),this};function o2(e,t,r){e.length<40?Ar.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}He.prototype.string=function(t){var r=Ar.Buffer.byteLength(t);return this.uint32(r),r&&this._push(o2,r,t),this};He._configure()});var fh=Q((R8,ch)=>{var Et=gt();Nr();Pt();var fi=ch.exports=Et.sha512=Et.sha512||{};Et.md.sha512=Et.md.algorithms.sha512=fi;var sh=Et.sha384=Et.sha512.sha384=Et.sha512.sha384||{};sh.create=function(){return fi.create("SHA-384")};Et.md.sha384=Et.md.algorithms.sha384=sh;Et.sha512.sha256=Et.sha512.sha256||{create:function(){return fi.create("SHA-512/256")}};Et.md["sha512/256"]=Et.md.algorithms["sha512/256"]=Et.sha512.sha256;Et.sha512.sha224=Et.sha512.sha224||{create:function(){return fi.create("SHA-512/224")}};Et.md["sha512/224"]=Et.md.algorithms["sha512/224"]=Et.sha512.sha224;fi.create=function(e){if(ah||y2(),typeof e>"u"&&(e="SHA-512"),!(e in zr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=zr[e],r=null,n=Et.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=Et.util.createBuffer(),r=new Array(t.length);for(var f=0;f<t.length;++f)r[f]=t[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=Et.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),oh(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=Et.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(Da.substr(0,a.blockLength-u));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,c.putInt32(d>>>0),d=h>>>0;c.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);oh(y,i,c);var g=Et.util.createBuffer(),m;e==="SHA-512"?m=y.length:e==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)g.putInt32(y[p][0]),(p!==m-1||e!=="SHA-512/224")&&g.putInt32(y[p][1]);return g},a};var Da=null,ah=!1,Ua=null,zr=null;function y2(){Da=String.fromCharCode(128),Da+=Et.util.fillString(String.fromCharCode(0),128),Ua=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],zr={},zr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],zr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],zr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],zr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ah=!0}function oh(e,t,r){for(var n,i,o,s,a,c,f,u,h,l,d,p,y,g,m,E,b,C,v,A,P,k,R,$,V,H,z,it,W,Y,N,L,S,D,F,q=r.length();q>=128;){for(W=0;W<16;++W)t[W][0]=r.getInt32()>>>0,t[W][1]=r.getInt32()>>>0;for(;W<80;++W)L=t[W-2],Y=L[0],N=L[1],n=((Y>>>19|N<<13)^(N>>>29|Y<<3)^Y>>>6)>>>0,i=((Y<<13|N>>>19)^(N<<3|Y>>>29)^(Y<<26|N>>>6))>>>0,D=t[W-15],Y=D[0],N=D[1],o=((Y>>>1|N<<31)^(Y>>>8|N<<24)^Y>>>7)>>>0,s=((Y<<31|N>>>1)^(Y<<24|N>>>8)^(Y<<25|N>>>7))>>>0,S=t[W-7],F=t[W-16],N=i+S[1]+s+F[1],t[W][0]=n+S[0]+o+F[0]+(N/4294967296>>>0)>>>0,t[W][1]=N>>>0;for(y=e[0][0],g=e[0][1],m=e[1][0],E=e[1][1],b=e[2][0],C=e[2][1],v=e[3][0],A=e[3][1],P=e[4][0],k=e[4][1],R=e[5][0],$=e[5][1],V=e[6][0],H=e[6][1],z=e[7][0],it=e[7][1],W=0;W<80;++W)f=((P>>>14|k<<18)^(P>>>18|k<<14)^(k>>>9|P<<23))>>>0,u=((P<<18|k>>>14)^(P<<14|k>>>18)^(k<<23|P>>>9))>>>0,h=(V^P&(R^V))>>>0,l=(H^k&($^H))>>>0,a=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,c=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,d=(y&m|b&(y^m))>>>0,p=(g&E|C&(g^E))>>>0,N=it+u+l+Ua[W][1]+t[W][1],n=z+f+h+Ua[W][0]+t[W][0]+(N/4294967296>>>0)>>>0,i=N>>>0,N=c+p,o=a+d+(N/4294967296>>>0)>>>0,s=N>>>0,z=V,it=H,V=R,H=$,R=P,$=k,N=A+i,P=v+n+(N/4294967296>>>0)>>>0,k=N>>>0,v=b,A=C,b=m,C=E,m=y,E=g,N=i+s,y=n+o+(N/4294967296>>>0)>>>0,g=N>>>0;N=e[0][1]+g,e[0][0]=e[0][0]+y+(N/4294967296>>>0)>>>0,e[0][1]=N>>>0,N=e[1][1]+E,e[1][0]=e[1][0]+m+(N/4294967296>>>0)>>>0,e[1][1]=N>>>0,N=e[2][1]+C,e[2][0]=e[2][0]+b+(N/4294967296>>>0)>>>0,e[2][1]=N>>>0,N=e[3][1]+A,e[3][0]=e[3][0]+v+(N/4294967296>>>0)>>>0,e[3][1]=N>>>0,N=e[4][1]+k,e[4][0]=e[4][0]+P+(N/4294967296>>>0)>>>0,e[4][1]=N>>>0,N=e[5][1]+$,e[5][0]=e[5][0]+R+(N/4294967296>>>0)>>>0,e[5][1]=N>>>0,N=e[6][1]+H,e[6][0]=e[6][0]+V+(N/4294967296>>>0)>>>0,e[6][1]=N>>>0,N=e[7][1]+it,e[7][0]=e[7][0]+z+(N/4294967296>>>0)>>>0,e[7][1]=N>>>0,q-=128}}});var Yh=Q((Q3,Zh)=>{var kn=1e3,Dn=kn*60,Un=Dn*60,Zr=Un*24,j2=Zr*7,J2=Zr*365.25;Zh.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return tx(e);if(r==="number"&&isFinite(e))return t.long?rx(e):ex(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function tx(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*J2;case"weeks":case"week":case"w":return r*j2;case"days":case"day":case"d":return r*Zr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Un;case"minutes":case"minute":case"mins":case"min":case"m":return r*Dn;case"seconds":case"second":case"secs":case"sec":case"s":return r*kn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function ex(e){var t=Math.abs(e);return t>=Zr?Math.round(e/Zr)+"d":t>=Un?Math.round(e/Un)+"h":t>=Dn?Math.round(e/Dn)+"m":t>=kn?Math.round(e/kn)+"s":e+"ms"}function rx(e){var t=Math.abs(e);return t>=Zr?Ro(e,t,Zr,"day"):t>=Un?Ro(e,t,Un,"hour"):t>=Dn?Ro(e,t,Dn,"minute"):t>=kn?Ro(e,t,kn,"second"):e+" ms"}function Ro(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var Qh=Q((j3,Xh)=>{function nx(e){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=i,r.enabled=s,r.humanize=Yh(),r.destroy=f,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(u){let h,l=null,d,p;function y(...g){if(!y.enabled)return;let m=y,E=Number(new Date),b=E-(h||E);m.diff=b,m.prev=h,m.curr=E,h=E,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let C=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(A,P)=>{if(A==="%%")return"%";C++;let k=r.formatters[P];if(typeof k=="function"){let R=g[C];A=k.call(m,R),g.splice(C,1),C--}return A}),r.formatArgs.call(m,g),(m.log||r.log).apply(m,g)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:g=>{l=g}}),typeof r.init=="function"&&r.init(y),y}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Xh.exports=nx});var jh=Q((he,No)=>{he.formatArgs=ox;he.save=sx;he.load=ax;he.useColors=ix;he.storage=cx();he.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();he.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function ix(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ox(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+No.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}he.log=console.debug||console.log||(()=>{});function sx(e){try{e?he.storage.setItem("debug",e):he.storage.removeItem("debug")}catch{}}function ax(){let e;try{e=he.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function cx(){try{return localStorage}catch{}}No.exports=Qh()(he);var{formatters:fx}=No.exports;fx.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var px={};$t(px,{noise:()=>lx,pureJsCrypto:()=>zi});function nr(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function $e(e=0){return globalThis.Buffer?.alloc!=null?nr(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function pe(e=0){return globalThis.Buffer?.allocUnsafe!=null?nr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Kt(e,t){t==null&&(t=e.reduce((i,o)=>i+o.length,0));let r=pe(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return nr(r)}function Ft(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var l0=Symbol.for("@achingbrain/uint8arraylist");function h0(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function Bi(e){return!!e?.[l0]}var ee=class{constructor(...t){Object.defineProperty(this,l0,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Bi(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Bi(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=h0(this.bufs,t);return r.buf[r.index]}set(t,r){let n=h0(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(Bi(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Kt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Kt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),o=new ee;return o.length=i,o.bufs=n,o}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,t>=c)continue;let f=t>=a&&t<c,u=r>a&&r<=c;if(f&&u){if(t===a&&r===c){n.push(s);break}let h=t-a;n.push(s.subarray(h,h+(r-t)));break}if(f){if(t===0){n.push(s);continue}n.push(s.subarray(t-a));continue}if(u){if(r===c){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!Bi(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let h=r;h<=c;h+=u){u=0;for(let l=f;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-a[d]);break}}if(u===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=$e(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=$e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=$e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=pe(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=$e(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=$e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=$e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=$e(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=$e(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof ee)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Ft(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new ee;return n.bufs=t,r==null&&(r=t.reduce((i,o)=>i+o.byteLength,0)),n.length=r,n}};function Ai(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var p0=4294967296,se=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new se(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new se(r,n)}toBytes(t,r=0){let n=Ai(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new se;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>p0&&(i=0,++n>p0&&(n=0))),new se(n,i)}static fromNumber(t){if(t===0)return new se;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new se(i,n)}static fromBytes(t,r=0){let n=Ai(t),i=new se,o=0;if(t.length-r>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;o=0}else for(;o<4;++o){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;o<5;++o){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var bl=Math.pow(2,7),wl=Math.pow(2,14),vl=Math.pow(2,21),El=Math.pow(2,28),Sl=Math.pow(2,35),Bl=Math.pow(2,42),Al=Math.pow(2,49),Cl=Math.pow(2,56),Il=Math.pow(2,63),We={encodingLength(e){return e<bl?1:e<wl?2:e<vl?3:e<El?4:e<Sl?5:e<Bl?6:e<Al?7:e<Cl?8:e<Il?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=pe(We.encodingLength(e))),se.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return se.fromBytes(e,t).toNumber(!0)}};function Ci(e){return e[Symbol.asyncIterator]!=null}var Ii=e=>{let t=We.encodingLength(e),r=pe(t);return We.encode(e,r),Ii.bytes=t,r};Ii.bytes=0;function _i(e,t){t=t??{};let r=t.lengthEncoder??Ii;function*n(i){let o=r(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Ci(e)?async function*(){for await(let i of e)yield*n(i)}():function*(){for(let i of e)yield*n(i)}()}_i.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??Ii;return new ee(r(e.byteLength),e)};var Yr=_t(Fo(),1);var Tl=8,Ll=1024*1024*4,Tr;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(Tr||(Tr={}));var Mo=e=>{let t=We.decode(e);return Mo.bytes=We.encodingLength(t),t};Mo.bytes=0;function Kn(e,t){let r=new ee,n=Tr.LENGTH,i=-1,o=t?.lengthDecoder??Mo,s=t?.maxLengthLength??Tl,a=t?.maxDataLength??Ll;function*c(){for(;r.byteLength>0;){if(n===Tr.LENGTH)try{if(i=o(r),i<0)throw(0,Yr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,Yr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let f=o.bytes;r.consume(f),t?.onLength!=null&&t.onLength(i),n=Tr.DATA}catch(f){if(f instanceof RangeError){if(r.byteLength>s)throw(0,Yr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw f}if(n===Tr.DATA){if(r.byteLength<i)break;let f=r.sublist(0,i);r.consume(i),t?.onData!=null&&t.onData(f),yield f,n=Tr.LENGTH}}}return Ci(e)?async function*(){for await(let f of e)r.append(f),yield*c();if(r.byteLength>0)throw(0,Yr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let f of e)r.append(f),yield*c();if(r.byteLength>0)throw(0,Yr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Kn.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:o,value:s}=await e.next(r);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{r=1}}();return Kn(n,{...t??{},onLength:o=>{r=o}})};function Xr(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}function Ho(){let e=Xr(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function g0(){let e=Ho(),t=Ho();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}var Li=_t(Fo(),1);var Ti=class{buffer;mask;top;btm;next;constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},Qr=class{size;hwm;head;tail;constructor(t={}){this.hwm=t.splitLimit??16,this.head=new Ti(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new Ti(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};var Vo=class extends Error{type;code;constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function jr(e={}){return Nl(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Nl(e,t){t=t??{};let r=t.onEnd,n=new Qr,i,o,s,a=Xr(),c=async()=>{try{return n.isEmpty()?s?{done:!0}:await new Promise((g,m)=>{o=E=>{o=null,n.push(E);try{g(e(n))}catch(b){m(b)}return i}}):e(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=Xr()})}},f=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new Qr,o!=null?o({error:g}):(n.push({error:g}),i)),h=g=>{if(s)return i;if(t?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:g})},l=g=>s?i:(s=!0,g!=null?u(g):f({done:!0})),d=()=>(n=new Qr,l(),{done:!0}),p=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:d,throw:p,push:h,end:l,get readableLength(){return n.size},onEmpty:async g=>{let m=g?.signal;if(m?.throwIfAborted(),n.isEmpty())return;let E,b;m!=null&&(E=new Promise((C,v)=>{b=()=>{v(new Vo)},m.addEventListener("abort",b)}));try{await Promise.race([a.promise,E])}finally{b!=null&&m!=null&&m?.removeEventListener("abort",b)}}},r==null)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return y.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(g){return y.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return y.readableLength}},i}var x0=e=>We.decode(e);x0.bytes=0;function qo(e,t){let r=jr();e.sink(r).catch(s=>{r.end(s)}),e.sink=async s=>{for await(let a of s)r.push(a);r.end()};let n=e.source;e.source[Symbol.iterator]!=null?n=e.source[Symbol.iterator]():e.source[Symbol.asyncIterator]!=null&&(n=e.source[Symbol.asyncIterator]());let i=new ee,o={read:async s=>{if(s==null){let{done:c,value:f}=await n.next();return c===!0?new ee:f}for(;i.byteLength<s;){let{value:c,done:f}=await n.next();if(f===!0)throw(0,Li.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");i.append(c)}let a=i.sublist(0,s);return i.consume(s),a},readLP:async()=>{let s=-1,a=new ee,c=t?.lengthDecoder??x0;for(;;){a.append(await o.read(1));try{s=c(a)}catch(f){if(f instanceof RangeError)continue;throw f}if(s>-1)break;if(t?.maxLengthLength!=null&&a.byteLength>t.maxLengthLength)throw(0,Li.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG")}if(t?.maxDataLength!=null&&s>t.maxDataLength)throw(0,Li.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");return o.read(s)},readPB:async s=>{let a=await o.readLP();if(a==null)throw new Error("Value is null");let c=a instanceof Uint8Array?a:a.subarray();return s.decode(c)},write:s=>{s instanceof Uint8Array?r.push(s):r.push(s.subarray())},writeLP:s=>{o.write(_i.single(s,t))},writePB:(s,a)=>{o.writeLP(a.encode(s))},pb:s=>({read:async()=>o.readPB(s),write:a=>{o.writePB(a,s)},unwrap:()=>o}),unwrap:()=>{let s=e.source;return e.source=async function*(){yield*i,yield*s}(),e}};return o}function kl(e){return e[Symbol.asyncIterator]!=null}function Dl(...e){let t=[];for(let r of e)kl(r)||t.push(r);return t.length===e.length?function*(){for(let r of t)yield*r}():async function*(){let r=jr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var m0=Dl;function b0(e,...t){if(e==null)throw new Error("Empty pipeline");if(zo(e)){let n=e;e=()=>n.source}else if(v0(e)||w0(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&zo(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)zo(r[n])&&(r[n]=Pl(r[n]));return Ul(...r)}var Ul=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},w0=e=>e?.[Symbol.asyncIterator]!=null,v0=e=>e?.[Symbol.iterator]!=null,zo=e=>e==null?!1:e.sink!=null&&e.source!=null,Pl=e=>t=>{let r=e.sink(t);if(r?.then!=null){let n=jr({objectMode:!0});r.then(()=>{n.end()},s=>{n.end(s)});let i,o=e.source;if(w0(o))i=async function*(){yield*o,n.end()};else if(v0(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return m0(n,i())}return e.source};var E0=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var Kl=e=>e instanceof Uint8Array;var de=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),S0=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ol=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ol)throw new Error("Non little-endian hardware is not supported");function Ri(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ni(e){if(typeof e=="string"&&(e=Ri(e)),!Kl(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var Fl=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function B0(e,t){if(t!==void 0&&(typeof t!="object"||!Fl(t)))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function On(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof t=="number"&&e.length!==t)throw new Error(`Uint8Array length ${t} expected`)}function A0(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<e.length;n++)r&&(r=e[n]===t[n]);return r}function Go(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+f,a,n)}function $o(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ml(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function C0(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Hl(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$o(e.outputLen),$o(e.blockLen)}function Vl(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ql(e,t){C0(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var zl={number:$o,bool:Ml,bytes:C0,hash:Hl,exists:Vl,output:ql},Qt=zl;var Wt=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Wo=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Ni(t),On(t,32);let r=Wt(t,0),n=Wt(t,2),i=Wt(t,4),o=Wt(t,6),s=Wt(t,8),a=Wt(t,10),c=Wt(t,12),f=Wt(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Wt(t,16+2*u)}process(t,r,n=!1){let i=n?0:2048,{h:o,r:s}=this,a=s[0],c=s[1],f=s[2],u=s[3],h=s[4],l=s[5],d=s[6],p=s[7],y=s[8],g=s[9],m=Wt(t,r+0),E=Wt(t,r+2),b=Wt(t,r+4),C=Wt(t,r+6),v=Wt(t,r+8),A=Wt(t,r+10),P=Wt(t,r+12),k=Wt(t,r+14),R=o[0]+(m&8191),$=o[1]+((m>>>13|E<<3)&8191),V=o[2]+((E>>>10|b<<6)&8191),H=o[3]+((b>>>7|C<<9)&8191),z=o[4]+((C>>>4|v<<12)&8191),it=o[5]+(v>>>1&8191),W=o[6]+((v>>>14|A<<2)&8191),Y=o[7]+((A>>>11|P<<5)&8191),N=o[8]+((P>>>8|k<<8)&8191),L=o[9]+(k>>>5|i),S=0,D=S+R*a+$*(5*g)+V*(5*y)+H*(5*p)+z*(5*d);S=D>>>13,D&=8191,D+=it*(5*l)+W*(5*h)+Y*(5*u)+N*(5*f)+L*(5*c),S+=D>>>13,D&=8191;let F=S+R*c+$*a+V*(5*g)+H*(5*y)+z*(5*p);S=F>>>13,F&=8191,F+=it*(5*d)+W*(5*l)+Y*(5*h)+N*(5*u)+L*(5*f),S+=F>>>13,F&=8191;let q=S+R*f+$*c+V*a+H*(5*g)+z*(5*y);S=q>>>13,q&=8191,q+=it*(5*p)+W*(5*d)+Y*(5*l)+N*(5*h)+L*(5*u),S+=q>>>13,q&=8191;let j=S+R*u+$*f+V*c+H*a+z*(5*g);S=j>>>13,j&=8191,j+=it*(5*y)+W*(5*p)+Y*(5*d)+N*(5*l)+L*(5*h),S+=j>>>13,j&=8191;let nt=S+R*h+$*u+V*f+H*c+z*a;S=nt>>>13,nt&=8191,nt+=it*(5*g)+W*(5*y)+Y*(5*p)+N*(5*d)+L*(5*l),S+=nt>>>13,nt&=8191;let pt=S+R*l+$*h+V*u+H*f+z*c;S=pt>>>13,pt&=8191,pt+=it*a+W*(5*g)+Y*(5*y)+N*(5*p)+L*(5*d),S+=pt>>>13,pt&=8191;let et=S+R*d+$*l+V*h+H*u+z*f;S=et>>>13,et&=8191,et+=it*c+W*a+Y*(5*g)+N*(5*y)+L*(5*p),S+=et>>>13,et&=8191;let ft=S+R*p+$*d+V*l+H*h+z*u;S=ft>>>13,ft&=8191,ft+=it*f+W*c+Y*a+N*(5*g)+L*(5*y),S+=ft>>>13,ft&=8191;let It=S+R*y+$*p+V*d+H*l+z*h;S=It>>>13,It&=8191,It+=it*u+W*f+Y*c+N*a+L*(5*g),S+=It>>>13,It&=8191;let Dt=S+R*g+$*y+V*p+H*d+z*l;S=Dt>>>13,Dt&=8191,Dt+=it*h+W*u+Y*f+N*c+L*a,S+=Dt>>>13,Dt&=8191,S=(S<<2)+S|0,S=S+D|0,D=S&8191,S=S>>>13,F+=S,o[0]=D,o[1]=F,o[2]=q,o[3]=j,o[4]=nt,o[5]=pt,o[6]=et,o[7]=ft,o[8]=It,o[9]=Dt}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),i=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=i,i=t[a]>>>13,t[a]&=8191;t[0]+=i*5,i=t[0]>>>13,t[0]&=8191,t[1]+=i,i=t[1]>>>13,t[1]&=8191,t[2]+=i,n[0]=t[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=t[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)n[a]&=o;o=~o;for(let a=0;a<10;a++)t[a]=t[a]&o|n[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let s=t[0]+r[0];t[0]=s&65535;for(let a=1;a<8;a++)s=(t[a]+r[a]|0)+(s>>>16)|0,t[a]=s&65535}update(t){Qt.exists(this);let{buffer:r,blockLen:n}=this;t=Ni(t);let i=t.length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){for(;n<=i-o;o+=n)this.process(t,o);continue}r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){Qt.exists(this),Qt.output(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)t[o++]=n[s]>>>0,t[o++]=n[s]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function Gl(e){let t=(n,i)=>e(i).update(Ni(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}var I0=Gl(e=>new Wo(e));var $l=Ri("expand 16-byte k"),Wl=Ri("expand 32-byte k"),Zl=de($l),Yl=de(Wl),_0=e=>!(e.byteOffset%4),Jr=e=>{let{core:t,rounds:r,counterRight:n,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=B0({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},e);Qt.number(i),Qt.number(r),Qt.number(a),Qt.bool(n),Qt.bool(o);let c=a/4;if(a%4!==0)throw new Error("Salsa/ChaCha: blockLen should be aligned to 4 bytes");return(f,u,h,l,d=0)=>{if(Qt.bytes(f),Qt.bytes(u),Qt.bytes(h),l||(l=new Uint8Array(h.length)),Qt.bytes(l),Qt.number(d),d<0||d>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(l.length<h.length)throw new Error(`Salsa/ChaCha: output (${l.length}) is shorter than data (${h.length})`);let p=[],y,g;if(f.length===32)y=f,g=Yl;else if(f.length===16&&o)y=new Uint8Array(32),y.set(f),y.set(f,16),g=Zl,p.push(y);else throw new Error(`Salsa/ChaCha: wrong key length=${f.length}, expected`);if(s){if(u.length<=16)throw new Error("Salsa/ChaCha: extended nonce should be bigger than 16 bytes");y=s(g,y,u.subarray(0,16),new Uint8Array(32)),p.push(y),u=u.subarray(16)}let m=16-i;if(u.length!==m)throw new Error(`Salsa/ChaCha: nonce should be ${m} or 16 bytes`);if(m!==12){let R=new Uint8Array(12);R.set(u,n?0:12-u.length),p.push(u=R)}let E=new Uint8Array(a),b=de(E),C=de(y),v=de(u),A=_0(h)&&de(h),P=_0(l)&&de(l);p.push(b);let k=h.length;for(let R=0,$=d;R<k;$++){if(t(g,C,v,b,$,r),$>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let V=Math.min(a,k-R);if(V===a&&P&&A){let H=R/4;if(R%4!==0)throw new Error("Salsa/ChaCha: wrong block position");for(let z=0;z<c;z++)P[H+z]=A[H+z]^b[z];R+=a;continue}for(let H=0;H<V;H++)l[R+H]=h[R+H]^E[H];R+=V}for(let R=0;R<p.length;R++)p[R].fill(0);return l}};var M=(e,t)=>e<<t|e>>>32-t;function Fn(e,t,r,n,i,o=20){let s=e[0],a=e[1],c=e[2],f=e[3],u=t[0],h=t[1],l=t[2],d=t[3],p=t[4],y=t[5],g=t[6],m=t[7],E=i,b=r[0],C=r[1],v=r[2],A=s,P=a,k=c,R=f,$=u,V=h,H=l,z=d,it=p,W=y,Y=g,N=m,L=E,S=b,D=C,F=v;for(let j=0;j<o;j+=2)A=A+$|0,L=M(L^A,16),it=it+L|0,$=M($^it,12),A=A+$|0,L=M(L^A,8),it=it+L|0,$=M($^it,7),P=P+V|0,S=M(S^P,16),W=W+S|0,V=M(V^W,12),P=P+V|0,S=M(S^P,8),W=W+S|0,V=M(V^W,7),k=k+H|0,D=M(D^k,16),Y=Y+D|0,H=M(H^Y,12),k=k+H|0,D=M(D^k,8),Y=Y+D|0,H=M(H^Y,7),R=R+z|0,F=M(F^R,16),N=N+F|0,z=M(z^N,12),R=R+z|0,F=M(F^R,8),N=N+F|0,z=M(z^N,7),A=A+V|0,F=M(F^A,16),Y=Y+F|0,V=M(V^Y,12),A=A+V|0,F=M(F^A,8),Y=Y+F|0,V=M(V^Y,7),P=P+H|0,L=M(L^P,16),N=N+L|0,H=M(H^N,12),P=P+H|0,L=M(L^P,8),N=N+L|0,H=M(H^N,7),k=k+z|0,S=M(S^k,16),it=it+S|0,z=M(z^it,12),k=k+z|0,S=M(S^k,8),it=it+S|0,z=M(z^it,7),R=R+$|0,D=M(D^R,16),W=W+D|0,$=M($^W,12),R=R+$|0,D=M(D^R,8),W=W+D|0,$=M($^W,7);let q=0;n[q++]=s+A|0,n[q++]=a+P|0,n[q++]=c+k|0,n[q++]=f+R|0,n[q++]=u+$|0,n[q++]=h+V|0,n[q++]=l+H|0,n[q++]=d+z|0,n[q++]=p+it|0,n[q++]=y+W|0,n[q++]=g+Y|0,n[q++]=m+N|0,n[q++]=E+L|0,n[q++]=b+S|0,n[q++]=C+D|0,n[q++]=v+F|0}function Xl(e,t,r,n){let i=de(t),o=de(r),s=de(n),a=e[0],c=e[1],f=e[2],u=e[3],h=i[0],l=i[1],d=i[2],p=i[3],y=i[4],g=i[5],m=i[6],E=i[7],b=o[0],C=o[1],v=o[2],A=o[3];for(let P=0;P<20;P+=2)a=a+h|0,b=M(b^a,16),y=y+b|0,h=M(h^y,12),a=a+h|0,b=M(b^a,8),y=y+b|0,h=M(h^y,7),c=c+l|0,C=M(C^c,16),g=g+C|0,l=M(l^g,12),c=c+l|0,C=M(C^c,8),g=g+C|0,l=M(l^g,7),f=f+d|0,v=M(v^f,16),m=m+v|0,d=M(d^m,12),f=f+d|0,v=M(v^f,8),m=m+v|0,d=M(d^m,7),u=u+p|0,A=M(A^u,16),E=E+A|0,p=M(p^E,12),u=u+p|0,A=M(A^u,8),E=E+A|0,p=M(p^E,7),a=a+l|0,A=M(A^a,16),m=m+A|0,l=M(l^m,12),a=a+l|0,A=M(A^a,8),m=m+A|0,l=M(l^m,7),c=c+d|0,b=M(b^c,16),E=E+b|0,d=M(d^E,12),c=c+d|0,b=M(b^c,8),E=E+b|0,d=M(d^E,7),f=f+p|0,C=M(C^f,16),y=y+C|0,p=M(p^y,12),f=f+p|0,C=M(C^f,8),y=y+C|0,p=M(p^y,7),u=u+h|0,v=M(v^u,16),g=g+v|0,h=M(h^g,12),u=u+h|0,v=M(v^u,8),g=g+v|0,h=M(h^g,7);return s[0]=a,s[1]=c,s[2]=f,s[3]=u,s[4]=b,s[5]=C,s[6]=v,s[7]=A,n}var vm=Jr({core:Fn,counterRight:!1,counterLen:8}),Ql=Jr({core:Fn,counterRight:!1,counterLen:4,allow128bitKeys:!1}),jl=Jr({core:Fn,counterRight:!1,counterLen:8,extendNonceFn:Xl,allow128bitKeys:!1}),Em=Jr({core:Fn,counterRight:!1,counterLen:4,rounds:8}),Sm=Jr({core:Fn,counterRight:!1,counterLen:4,rounds:12}),Jl=new Uint8Array(16),T0=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(Jl.subarray(r))},L0=(e,t,r,n,i)=>{let o=e(t,r,new Uint8Array(32)),s=I0.create(o);i&&T0(s,i),T0(s,n);let a=new Uint8Array(16),c=S0(a);Go(c,0,BigInt(i?i.length:0),!0),Go(c,8,BigInt(n.length),!0),s.update(a);let f=s.digest();return o.fill(0),f},R0=e=>(t,r,n)=>(On(t,32),On(r),{tagLength:16,encrypt:o=>{let s=new Uint8Array(o.length+16);e(t,r,o,s,1);let a=L0(e,t,r,s.subarray(0,-16),n);return s.set(a,o.length),s},decrypt:o=>{if(o.length<16)throw new Error("Encrypted data should be at least 16");let s=o.subarray(-16),a=o.subarray(0,-16),c=L0(e,t,r,a,n);if(!A0(s,c))throw new Error("Wrong tag");return e(t,r,a,void 0,1)}}),Zo=R0(Ql),Bm=R0(jl);function Yo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function tp(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function N0(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function ep(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Yo(e.outputLen),Yo(e.blockLen)}function rp(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function np(e,t){N0(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var ip={number:Yo,bool:tp,bytes:N0,hash:ep,exists:rp,output:np},ae=ip;var ki=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var k0=e=>e instanceof Uint8Array;var Di=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ve=(e,t)=>e<<32-t|e>>>t,op=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!op)throw new Error("Non little-endian hardware is not supported");var Tm=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Xo(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function ir(e){if(typeof e=="string"&&(e=Xo(e)),!k0(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function D0(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!k0(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var tn=class{clone(){return this._cloneInto()}};function or(e){let t=n=>e().update(ir(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Qo(e=32){if(ki&&typeof ki.getRandomValues=="function")return ki.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function sp(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+f,a,n)}var en=class extends tn{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Di(this.buffer)}update(t){ae.exists(this);let{view:r,buffer:n,blockLen:i}=this;t=ir(t);let o=t.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=Di(t);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ae.exists(this),ae.output(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;sp(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Di(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=s,i%r&&t.buffer.set(n),t}};var Ui=BigInt(4294967295),jo=BigInt(32);function U0(e,t=!1){return t?{h:Number(e&Ui),l:Number(e>>jo&Ui)}:{h:Number(e>>jo&Ui)|0,l:Number(e&Ui)|0}}function ap(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:o,l:s}=U0(e[i],t);[r[i],n[i]]=[o,s]}return[r,n]}var cp=(e,t)=>BigInt(e>>>0)<<jo|BigInt(t>>>0),fp=(e,t,r)=>e>>>r,up=(e,t,r)=>e<<32-r|t>>>r,hp=(e,t,r)=>e>>>r|t<<32-r,lp=(e,t,r)=>e<<32-r|t>>>r,pp=(e,t,r)=>e<<64-r|t>>>r-32,dp=(e,t,r)=>e>>>r-32|t<<64-r,yp=(e,t)=>t,gp=(e,t)=>e,xp=(e,t,r)=>e<<r|t>>>32-r,mp=(e,t,r)=>t<<r|e>>>32-r,bp=(e,t,r)=>t<<r-32|e>>>64-r,wp=(e,t,r)=>e<<r-32|t>>>64-r;function vp(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var Ep=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Sp=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Bp=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Ap=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,Cp=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Ip=(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,_p={fromBig:U0,split:ap,toBig:cp,shrSH:fp,shrSL:up,rotrSH:hp,rotrSL:lp,rotrBH:pp,rotrBL:dp,rotr32H:yp,rotr32L:gp,rotlSH:xp,rotlSL:mp,rotlBH:bp,rotlBL:wp,add:vp,add3L:Ep,add3H:Sp,add4L:Bp,add4H:Ap,add5H:Ip,add5L:Cp},J=_p;var[Tp,Lp]=J.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),sr=new Uint32Array(80),ar=new Uint32Array(80),rn=class extends en{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:d,Gl:p,Hh:y,Hl:g}=this;return[t,r,n,i,o,s,a,c,f,u,h,l,d,p,y,g]}set(t,r,n,i,o,s,a,c,f,u,h,l,d,p,y,g){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=d|0,this.Gl=p|0,this.Hh=y|0,this.Hl=g|0}process(t,r){for(let b=0;b<16;b++,r+=4)sr[b]=t.getUint32(r),ar[b]=t.getUint32(r+=4);for(let b=16;b<80;b++){let C=sr[b-15]|0,v=ar[b-15]|0,A=J.rotrSH(C,v,1)^J.rotrSH(C,v,8)^J.shrSH(C,v,7),P=J.rotrSL(C,v,1)^J.rotrSL(C,v,8)^J.shrSL(C,v,7),k=sr[b-2]|0,R=ar[b-2]|0,$=J.rotrSH(k,R,19)^J.rotrBH(k,R,61)^J.shrSH(k,R,6),V=J.rotrSL(k,R,19)^J.rotrBL(k,R,61)^J.shrSL(k,R,6),H=J.add4L(P,V,ar[b-7],ar[b-16]),z=J.add4H(H,A,$,sr[b-7],sr[b-16]);sr[b]=z|0,ar[b]=H|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:d,Fl:p,Gh:y,Gl:g,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let C=J.rotrSH(h,l,14)^J.rotrSH(h,l,18)^J.rotrBH(h,l,41),v=J.rotrSL(h,l,14)^J.rotrSL(h,l,18)^J.rotrBL(h,l,41),A=h&d^~h&y,P=l&p^~l&g,k=J.add5L(E,v,P,Lp[b],ar[b]),R=J.add5H(k,m,C,A,Tp[b],sr[b]),$=k|0,V=J.rotrSH(n,i,28)^J.rotrBH(n,i,34)^J.rotrBH(n,i,39),H=J.rotrSL(n,i,28)^J.rotrBL(n,i,34)^J.rotrBL(n,i,39),z=n&o^n&a^o&a,it=i&s^i&c^s&c;m=y|0,E=g|0,y=d|0,g=p|0,d=h|0,p=l|0,{h,l}=J.add(f|0,u|0,R|0,$|0),f=a|0,u=c|0,a=o|0,c=s|0,o=n|0,s=i|0;let W=J.add3L($,H,it);n=J.add3H(W,R,V,z),i=W|0}({h:n,l:i}=J.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=J.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:c}=J.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=J.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=J.add(this.Eh|0,this.El|0,h|0,l|0),{h:d,l:p}=J.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:y,l:g}=J.add(this.Gh|0,this.Gl|0,y|0,g|0),{h:m,l:E}=J.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,o,s,a,c,f,u,h,l,d,p,y,g,m,E)}roundClean(){sr.fill(0),ar.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Jo=class extends rn{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},ts=class extends rn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},es=class extends rn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},rs=or(()=>new rn),Om=or(()=>new Jo),Fm=or(()=>new ts),Mm=or(()=>new es);var Vm=BigInt(0),Rp=BigInt(1),Np=BigInt(2),Pi=e=>e instanceof Uint8Array,kp=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Mn(e){if(!Pi(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=kp[e[r]];return t}function P0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function K0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let i=n*2,o=e.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function ns(e){return P0(Mn(e))}function Re(e){if(!Pi(e))throw new Error("Uint8Array expected");return P0(Mn(Uint8Array.from(e).reverse()))}function is(e,t){return K0(e.toString(16).padStart(t*2,"0"))}function cr(e,t){return is(e,t).reverse()}function re(e,t,r){let n;if(typeof t=="string")try{n=K0(t)}catch(o){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${o}`)}else if(Pi(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}function Ki(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Pi(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var O0=e=>(Np<<BigInt(e-1))-Rp;var Dp={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ze(e,t,r={}){let n=(i,o,s)=>{let a=Dp[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let c=e[i];if(!(s&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(let[i,o]of Object.entries(t))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return e}var Ot=BigInt(0),Rt=BigInt(1),Lr=BigInt(2),Pp=BigInt(3),os=BigInt(4),F0=BigInt(5),M0=BigInt(8),Kp=BigInt(9),Op=BigInt(16);function bt(e,t){let r=e%t;return r>=Ot?r:t+r}function ss(e,t,r){if(r<=Ot||t<Ot)throw new Error("Expected power/modulo > 0");if(r===Rt)return Ot;let n=Rt;for(;t>Ot;)t&Rt&&(n=n*e%r),e=e*e%r,t>>=Rt;return n}function ye(e,t,r){let n=e;for(;t-- >Ot;)n*=n,n%=r;return n}function H0(e,t){if(e===Ot||t<=Ot)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=bt(e,t),n=t,i=Ot,o=Rt,s=Rt,a=Ot;for(;r!==Ot;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==Rt)throw new Error("invert: does not exist");return bt(i,t)}function Fp(e){let t=(e-Rt)/Lr,r,n,i;for(r=e-Rt,n=0;r%Lr===Ot;r/=Lr,n++);for(i=Lr;i<e&&ss(i,t,e)!==e-Rt;i++);if(n===1){let s=(e+Rt)/os;return function(c,f){let u=c.pow(f,s);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let o=(r+Rt)/Lr;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,o),l=a.pow(c,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let d=1;for(let y=a.sqr(l);d<f&&!a.eql(y,a.ONE);d++)y=a.sqr(y);let p=a.pow(u,Rt<<BigInt(f-d-1));u=a.sqr(p),h=a.mul(h,p),l=a.mul(l,u),f=d}return h}}function Mp(e){if(e%os===Pp){let t=(e+Rt)/os;return function(n,i){let o=n.pow(i,t);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(e%M0===F0){let t=(e-F0)/M0;return function(n,i){let o=n.mul(i,Lr),s=n.pow(o,t),a=n.mul(i,s),c=n.mul(n.mul(a,Lr),s),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return e%Op,Fp(e)}var V0=(e,t)=>(bt(e,t)&Rt)===Rt,Hp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function q0(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Hp.reduce((n,i)=>(n[i]="function",n),t);return Ze(e,r)}function Vp(e,t,r){if(r<Ot)throw new Error("Expected power > 0");if(r===Ot)return e.ONE;if(r===Rt)return t;let n=e.ONE,i=t;for(;r>Ot;)r&Rt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Rt;return n}function qp(e,t){let r=new Array(t.length),n=t.reduce((o,s,a)=>e.is0(s)?o:(r[a]=o,e.mul(o,s)),e.ONE),i=e.inv(n);return t.reduceRight((o,s,a)=>e.is0(s)?o:(r[a]=e.mul(o,r[a]),e.mul(o,s)),i),r}function as(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function z0(e,t,r=!1,n={}){if(e<=Ot)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:o}=as(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Mp(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:O0(i),ZERO:Ot,ONE:Rt,create:c=>bt(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Ot<=c&&c<e},is0:c=>c===Ot,isOdd:c=>(c&Rt)===Rt,neg:c=>bt(-c,e),eql:(c,f)=>c===f,sqr:c=>bt(c*c,e),add:(c,f)=>bt(c+f,e),sub:(c,f)=>bt(c-f,e),mul:(c,f)=>bt(c*f,e),pow:(c,f)=>Vp(a,c,f),div:(c,f)=>bt(c*H0(f,e),e),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>H0(c,e),sqrt:n.sqrt||(c=>s(a,c)),invertBatch:c=>qp(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?cr(c,o):is(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return r?Re(c):ns(c)}});return Object.freeze(a)}function G0(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}var zp=BigInt(0),cs=BigInt(1);function $0(e,t){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(t/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=e.ZERO,a=i;for(;o>zp;)o&cs&&(s=s.add(a)),a=a.double(),o>>=cs;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),c=[],f=i,u=f;for(let h=0;h<s;h++){u=f,c.push(u);for(let l=1;l<a;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,o,s){let{windows:a,windowSize:c}=n(i),f=e.ZERO,u=e.BASE,h=BigInt(2**i-1),l=2**i,d=BigInt(i);for(let p=0;p<a;p++){let y=p*c,g=Number(s&h);s>>=d,g>c&&(g-=l,s+=cs);let m=y,E=y+Math.abs(g)-1,b=p%2!==0,C=g<0;g===0?u=u.add(r(b,o[m])):f=f.add(r(C,o[E]))}return{p:f,f:u}},wNAFCached(i,o,s,a){let c=i._WINDOW_SIZE||1,f=o.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&o.set(i,a(f))),this.wNAF(c,f,s)}}}function W0(e){return q0(e.Fp),Ze(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...as(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var Ee=BigInt(0),ce=BigInt(1),Oi=BigInt(2),Gp=BigInt(8),$p={zip215:!0};function Wp(e){let t=W0(e);return Ze(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Fi(e){let t=Wp(e),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,f=Oi<<BigInt(a*8)-ce,u=r.create,h=t.uvRatio||((L,S)=>{try{return{isValid:!0,value:r.sqrt(L*r.inv(S))}}catch{return{isValid:!1,value:Ee}}}),l=t.adjustScalarBytes||(L=>L),d=t.domain||((L,S,D)=>{if(S.length||D)throw new Error("Contexts/pre-hash are not supported");return L}),p=L=>typeof L=="bigint"&&Ee<L,y=(L,S)=>p(L)&&p(S)&&L<S,g=L=>L===Ee||y(L,f);function m(L,S){if(y(L,S))return L;throw new Error(`Expected valid scalar < ${S}, got ${typeof L} ${L}`)}function E(L){return L===Ee?L:m(L,n)}let b=new Map;function C(L){if(!(L instanceof v))throw new Error("ExtendedPoint expected")}class v{constructor(S,D,F,q){if(this.ex=S,this.ey=D,this.ez=F,this.et=q,!g(S))throw new Error("x required");if(!g(D))throw new Error("y required");if(!g(F))throw new Error("z required");if(!g(q))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(S){if(S instanceof v)throw new Error("extended point not allowed");let{x:D,y:F}=S||{};if(!g(D)||!g(F))throw new Error("invalid affine point");return new v(D,F,ce,u(D*F))}static normalizeZ(S){let D=r.invertBatch(S.map(F=>F.ez));return S.map((F,q)=>F.toAffine(D[q])).map(v.fromAffine)}_setWindowSize(S){this._WINDOW_SIZE=S,b.delete(this)}assertValidity(){let{a:S,d:D}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:F,ey:q,ez:j,et:nt}=this,pt=u(F*F),et=u(q*q),ft=u(j*j),It=u(ft*ft),Dt=u(pt*S),Le=u(ft*u(Dt+et)),te=u(It+u(D*u(pt*et)));if(Le!==te)throw new Error("bad point: equation left != right (1)");let rr=u(F*q),Ge=u(j*nt);if(rr!==Ge)throw new Error("bad point: equation left != right (2)")}equals(S){C(S);let{ex:D,ey:F,ez:q}=this,{ex:j,ey:nt,ez:pt}=S,et=u(D*pt),ft=u(j*q),It=u(F*pt),Dt=u(nt*q);return et===ft&&It===Dt}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:S}=t,{ex:D,ey:F,ez:q}=this,j=u(D*D),nt=u(F*F),pt=u(Oi*u(q*q)),et=u(S*j),ft=D+F,It=u(u(ft*ft)-j-nt),Dt=et+nt,Le=Dt-pt,te=et-nt,rr=u(It*Le),Ge=u(Dt*te),vi=u(It*te),Ei=u(Le*Dt);return new v(rr,Ge,Ei,vi)}add(S){C(S);let{a:D,d:F}=t,{ex:q,ey:j,ez:nt,et:pt}=this,{ex:et,ey:ft,ez:It,et:Dt}=S;if(D===BigInt(-1)){let n0=u((j-q)*(ft+et)),i0=u((j+q)*(ft-et)),Oo=u(i0-n0);if(Oo===Ee)return this.double();let o0=u(nt*Oi*Dt),s0=u(pt*Oi*It),a0=s0+o0,c0=i0+n0,f0=s0-o0,cl=u(a0*Oo),fl=u(c0*f0),ul=u(a0*f0),hl=u(Oo*c0);return new v(cl,fl,hl,ul)}let Le=u(q*et),te=u(j*ft),rr=u(pt*F*Dt),Ge=u(nt*It),vi=u((q+j)*(et+ft)-Le-te),Ei=Ge-rr,e0=Ge+rr,r0=u(te-D*Le),il=u(vi*Ei),ol=u(e0*r0),sl=u(vi*r0),al=u(Ei*e0);return new v(il,ol,al,sl)}subtract(S){return this.add(S.negate())}wNAF(S){return k.wNAFCached(this,b,S,v.normalizeZ)}multiply(S){let{p:D,f:F}=this.wNAF(m(S,n));return v.normalizeZ([D,F])[0]}multiplyUnsafe(S){let D=E(S);return D===Ee?P:this.equals(P)||D===ce?this:this.equals(A)?this.wNAF(D).p:k.unsafeLadder(this,D)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return k.unsafeLadder(this,n).is0()}toAffine(S){let{ex:D,ey:F,ez:q}=this,j=this.is0();S==null&&(S=j?Gp:r.inv(q));let nt=u(D*S),pt=u(F*S),et=u(q*S);if(j)return{x:Ee,y:ce};if(et!==ce)throw new Error("invZ was invalid");return{x:nt,y:pt}}clearCofactor(){let{h:S}=t;return S===ce?this:this.multiplyUnsafe(S)}static fromHex(S,D=!1){let{d:F,a:q}=t,j=r.BYTES;S=re("pointHex",S,j);let nt=S.slice(),pt=S[j-1];nt[j-1]=pt&-129;let et=Re(nt);et===Ee||(D?m(et,f):m(et,r.ORDER));let ft=u(et*et),It=u(ft-ce),Dt=u(F*ft-q),{isValid:Le,value:te}=h(It,Dt);if(!Le)throw new Error("Point.fromHex: invalid y coordinate");let rr=(te&ce)===ce,Ge=(pt&128)!==0;if(!D&&te===Ee&&Ge)throw new Error("Point.fromHex: x=0 and x_0=1");return Ge!==rr&&(te=u(-te)),v.fromAffine({x:te,y:et})}static fromPrivateKey(S){return V(S).point}toRawBytes(){let{x:S,y:D}=this.toAffine(),F=cr(D,r.BYTES);return F[F.length-1]|=S&ce?128:0,F}toHex(){return Mn(this.toRawBytes())}}v.BASE=new v(t.Gx,t.Gy,ce,u(t.Gx*t.Gy)),v.ZERO=new v(Ee,ce,ce,Ee);let{BASE:A,ZERO:P}=v,k=$0(v,a*8);function R(L){return bt(L,n)}function $(L){return R(Re(L))}function V(L){let S=a;L=re("private key",L,S);let D=re("hashed private key",o(L),2*S),F=l(D.slice(0,S)),q=D.slice(S,2*S),j=$(F),nt=A.multiply(j),pt=nt.toRawBytes();return{head:F,prefix:q,scalar:j,point:nt,pointBytes:pt}}function H(L){return V(L).pointBytes}function z(L=new Uint8Array,...S){let D=Ki(...S);return $(o(d(D,re("context",L),!!i)))}function it(L,S,D={}){L=re("message",L),i&&(L=i(L));let{prefix:F,scalar:q,pointBytes:j}=V(S),nt=z(D.context,F,L),pt=A.multiply(nt).toRawBytes(),et=z(D.context,pt,j,L),ft=R(nt+et*q);E(ft);let It=Ki(pt,cr(ft,r.BYTES));return re("result",It,a*2)}let W=$p;function Y(L,S,D,F=W){let{context:q,zip215:j}=F,nt=r.BYTES;L=re("signature",L,2*nt),S=re("message",S),i&&(S=i(S));let pt=Re(L.slice(nt,2*nt)),et,ft,It;try{et=v.fromHex(D,j),ft=v.fromHex(L.slice(0,nt),j),It=A.multiplyUnsafe(pt)}catch{return!1}if(!j&&et.isSmallOrder())return!1;let Dt=z(q,ft.toRawBytes(),et.toRawBytes(),S);return ft.add(et.multiplyUnsafe(Dt)).subtract(It).clearCofactor().equals(v.ZERO)}return A._setWindowSize(8),{CURVE:t,getPublicKey:H,sign:it,verify:Y,ExtendedPoint:v,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(L=8,S=v.BASE){return S._setWindowSize(L),S.multiply(BigInt(3)),S}}}}var Hn=BigInt(0),fs=BigInt(1);function Zp(e){return Ze(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function Z0(e){let t=Zp(e),{P:r}=t,n=b=>bt(b,r),i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,a=t.adjustScalarBytes||(b=>b),c=t.powPminus2||(b=>ss(b,r-BigInt(2),r));function f(b,C,v){let A=n(b*(C-v));return C=n(C-A),v=n(v+A),[C,v]}function u(b){if(typeof b=="bigint"&&Hn<=b&&b<r)return b;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(t.a-BigInt(2))/BigInt(4);function l(b,C){let v=u(b),A=u(C),P=v,k=fs,R=Hn,$=v,V=fs,H=Hn,z;for(let W=BigInt(i-1);W>=Hn;W--){let Y=A>>W&fs;H^=Y,z=f(H,k,$),k=z[0],$=z[1],z=f(H,R,V),R=z[0],V=z[1],H=Y;let N=k+R,L=n(N*N),S=k-R,D=n(S*S),F=L-D,q=$+V,j=$-V,nt=n(j*N),pt=n(q*S),et=nt+pt,ft=nt-pt;$=n(et*et),V=n(P*n(ft*ft)),k=n(L*D),R=n(F*(L+n(h*F)))}z=f(H,k,$),k=z[0],$=z[1],z=f(H,R,V),R=z[0],V=z[1];let it=c(R);return n(k*it)}function d(b){return cr(n(b),o)}function p(b){let C=re("u coordinate",b,o);return s===o&&(C[s-1]&=127),Re(C)}function y(b){let C=re("scalar",b);if(C.length!==o&&C.length!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${C.length}`);return Re(a(C))}function g(b,C){let v=p(C),A=y(b),P=l(v,A);if(P===Hn)throw new Error("Invalid private or public key received");return d(P)}let m=d(t.Gu);function E(b){return g(b,m)}return{scalarMult:g,scalarMultBase:E,getSharedSecret:(b,C)=>g(b,C),getPublicKey:b=>E(b),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:m}}var Vn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Y0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),yb=BigInt(0),Yp=BigInt(1),us=BigInt(2),Xp=BigInt(5),X0=BigInt(10),Qp=BigInt(20),jp=BigInt(40),Q0=BigInt(80);function j0(e){let t=Vn,n=e*e%t*e%t,i=ye(n,us,t)*n%t,o=ye(i,Yp,t)*e%t,s=ye(o,Xp,t)*o%t,a=ye(s,X0,t)*s%t,c=ye(a,Qp,t)*a%t,f=ye(c,jp,t)*c%t,u=ye(f,Q0,t)*f%t,h=ye(u,Q0,t)*f%t,l=ye(h,X0,t)*s%t;return{pow_p_5_8:ye(l,us,t)*e%t,b2:n}}function J0(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Jp(e,t){let r=Vn,n=bt(t*t*t,r),i=bt(n*n*t,r),o=j0(e*i).pow_p_5_8,s=bt(e*n*o,r),a=bt(t*s*s,r),c=s,f=bt(s*Y0,r),u=a===e,h=a===bt(-e,r),l=a===bt(-e*Y0,r);return u&&(s=c),(h||l)&&(s=f),V0(s,r)&&(s=bt(-s,r)),{isValid:u||h,value:s}}var Ye=z0(Vn,void 0,!0),hs={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ye,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:rs,randomBytes:Qo,adjustScalarBytes:J0,uvRatio:Jp},gb=Fi(hs);function tc(e,t,r){if(t.length>255)throw new Error("Context is too big");return D0(Xo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}var xb=Fi({...hs,domain:tc}),mb=Fi({...hs,domain:tc,prehash:rs}),qn=(()=>Z0({P:Vn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=Vn,{pow_p_5_8:r,b2:n}=j0(e);return bt(ye(r,BigInt(3),t)*n,t)},adjustScalarBytes:J0,randomBytes:Qo}))();var td=(Ye.ORDER+BigInt(3))/BigInt(8),bb=Ye.pow(us,td),wb=Ye.sqrt(Ye.neg(Ye.ONE)),vb=(Ye.ORDER-BigInt(5))/BigInt(8),Eb=BigInt(486662);var Sb=G0(Ye,Ye.neg(BigInt(486664)));var Bb=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Ab=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Cb=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ib=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var _b=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Mi=class extends tn{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,ae.hash(t);let n=ir(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?t.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return ae.exists(this),this.iHash.update(t),this}digestInto(t){ae.exists(this),ae.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=s,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Hi=(e,t,r)=>new Mi(e,t).update(r).digest();Hi.create=(e,t)=>new Mi(e,t);function rc(e,t,r){return ae.hash(e),r===void 0&&(r=new Uint8Array(e.outputLen)),Hi(e,ir(r),ir(t))}var ls=new Uint8Array([0]),ec=new Uint8Array;function nc(e,t,r,n=32){if(ae.hash(e),ae.number(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/e.outputLen);r===void 0&&(r=ec);let o=new Uint8Array(i*e.outputLen),s=Hi.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let f=0;f<i;f++)ls[0]=f+1,a.update(f===0?ec:c).update(r).update(ls).digestInto(c),o.set(c,e.outputLen*f),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),ls.fill(0),o.slice(0,n)}var ed=(e,t,r)=>e&t^~e&r,rd=(e,t,r)=>e&t^e&r^t&r,nd=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),fr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ur=new Uint32Array(64),Vi=class extends en{constructor(){super(64,32,8,!1),this.A=fr[0]|0,this.B=fr[1]|0,this.C=fr[2]|0,this.D=fr[3]|0,this.E=fr[4]|0,this.F=fr[5]|0,this.G=fr[6]|0,this.H=fr[7]|0}get(){let{A:t,B:r,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[t,r,n,i,o,s,a,c]}set(t,r,n,i,o,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)ur[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let l=ur[h-15],d=ur[h-2],p=ve(l,7)^ve(l,18)^l>>>3,y=ve(d,17)^ve(d,19)^d>>>10;ur[h]=y+ur[h-7]+p+ur[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=ve(a,6)^ve(a,11)^ve(a,25),d=u+l+ed(a,c,f)+nd[h]+ur[h]|0,y=(ve(n,2)^ve(n,13)^ve(n,22))+rd(n,i,o)|0;u=f,f=c,c=a,a=s+d|0,s=o,o=i,i=n,n=d+y|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,c,f,u)}roundClean(){ur.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},ps=class extends Vi{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},qi=or(()=>new Vi),Fb=or(()=>new ps);var zi={hashSHA256(e){return qi(e)},getHKDF(e,t){let r=rc(qi,t,e),i=nc(qi,r,void 0,96),o=i.subarray(0,32),s=i.subarray(32,64),a=i.subarray(64,96);return[o,s,a]},generateX25519KeyPair(){let e=qn.utils.randomPrivateKey();return{publicKey:qn.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed(e){return{publicKey:qn.getPublicKey(e),privateKey:e}},generateX25519SharedKey(e,t){return qn.getSharedSecret(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return Zo(n,t,r).encrypt(e)},chaCha20Poly1305Decrypt(e,t,r,n,i){let o=Zo(n,t,r).decrypt(e);return i&&i.set(o),o}};var id=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),nn=e=>{let t=id(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};nn.bytes=2;var zn=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};zn.bytes=2;function ic(e){return Kt([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function oc(e){return Kt([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function sc(e){return Kt([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function ac(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function cc(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function fc(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}var hc=16;function lc(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let o=i+65519;o>n.length&&(o=n.length);let s=e.encrypt(n.subarray(i,o),e.session);t?.encryptedPackets.increment(),yield nn(s.byteLength),yield s}}}function pc(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let o=i+65535;if(o>n.length&&(o=n.length),o-hc<i)throw new Error("Invalid chunk");let s=n.subarray(i,o),a=n.subarray(i,o-hc),{plaintext:c,valid:f}=e.decrypt(s,e.session,a);if(!f)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield c}}}var ds=class extends Error{code;constructor(t="Unexpected Peer"){super(t),this.code=ds.code}},on=ds;Si(on,"code","ERR_UNEXPECTED_PEER");var ys=class extends Error{code;constructor(t="Invalid crypto exchange"){super(t),this.code=ys.code}},hr=ys;Si(hr,"code","ERR_INVALID_CRYPTO_EXCHANGE");var l3=_t(Yn(),1),p3=_t(Lf(),1);var xt=class extends Error{code;props;constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var G2=_t(gt(),1);var Vs={};$t(Vs,{identity:()=>D1});function T1(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,c=e.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,g=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,y++;for(var b=(E-m)*u+1>>>0,C=new Uint8Array(b);m!==E;){for(var v=p[m],A=0,P=b-1;(v!==0||A<g)&&P!==-1;P--,A++)v+=256*C[P]>>>0,C[P]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");g=A,m++}for(var k=b-g;k!==b&&C[k]===0;)k++;for(var R=c.repeat(y);k<b;++k)R+=e.charAt(C[k]);return R}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var g=0,m=0;p[y]===c;)g++,y++;for(var E=(p.length-y)*f+1>>>0,b=new Uint8Array(E);p[y];){var C=r[p.charCodeAt(y)];if(C===255)return;for(var v=0,A=E-1;(C!==0||v<m)&&A!==-1;A--,v++)C+=a*b[A]>>>0,b[A]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");m=v,y++}if(p[y]!==" "){for(var P=E-m;P!==E&&b[P]===0;)P++;for(var k=new Uint8Array(g+(E-P)),R=g;P!==E;)k[R++]=b[P++];return k}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var L1=T1,R1=L1,Rf=R1;var Iw=new Uint8Array(0);var Nf=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Je=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var kf=e=>new TextEncoder().encode(e),Df=e=>new TextDecoder().decode(e);var Os=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Fs=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Pf(this,t)}},Ms=class{constructor(t){this.decoders=t}or(t){return Pf(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Pf=(e,t)=>new Ms({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Hs=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Os(t,r,n),this.decoder=new Fs(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},hn=({name:e,prefix:t,encode:r,decode:n})=>new Hs(e,t,r,n),gr=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=Rf(r,t);return hn({prefix:e,name:t,encode:n,decode:o=>Je(i(o))})},N1=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,c=0,f=0;for(let u=0;u<o;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,s[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},k1=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},Nt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>hn({prefix:t,name:e,encode(i){return k1(i,n,r)},decode(i){return N1(i,n,r,e)}});var D1=hn({prefix:"\0",name:"identity",encode:e=>Df(e),decode:e=>kf(e)});var qs={};$t(qs,{base2:()=>U1});var U1=Nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var zs={};$t(zs,{base8:()=>P1});var P1=Nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Gs={};$t(Gs,{base10:()=>K1});var K1=gr({prefix:"9",name:"base10",alphabet:"0123456789"});var $s={};$t($s,{base16:()=>O1,base16upper:()=>F1});var O1=Nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),F1=Nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ws={};$t(Ws,{base32:()=>xr,base32hex:()=>q1,base32hexpad:()=>G1,base32hexpadupper:()=>$1,base32hexupper:()=>z1,base32pad:()=>H1,base32padupper:()=>V1,base32upper:()=>M1,base32z:()=>W1});var xr=Nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M1=Nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),H1=Nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),V1=Nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),q1=Nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z1=Nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),G1=Nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$1=Nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W1=Nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zs={};$t(Zs,{base36:()=>Z1,base36upper:()=>Y1});var Z1=gr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Y1=gr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ys={};$t(Ys,{base58btc:()=>Zt,base58flickr:()=>X1});var Zt=gr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),X1=gr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xs={};$t(Xs,{base64:()=>ln,base64pad:()=>Q1,base64url:()=>j1,base64urlpad:()=>J1});var ln=Nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Q1=Nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),j1=Nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),J1=Nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Qs={};$t(Qs,{base256emoji:()=>ig});var Kf=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),tg=Kf.reduce((e,t,r)=>(e[r]=t,e),[]),eg=Kf.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function rg(e){return e.reduce((t,r)=>(t+=tg[r],t),"")}function ng(e){let t=[];for(let r of e){let n=eg[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var ig=hn({prefix:"\u{1F680}",name:"base256emoji",encode:rg,decode:ng});var ea={};$t(ea,{sha256:()=>Yt,sha512:()=>Sg});var og=Mf,Of=128,sg=127,ag=~sg,cg=Math.pow(2,31);function Mf(e,t,r){t=t||[],r=r||0;for(var n=r;e>=cg;)t[r++]=e&255|Of,e/=128;for(;e&ag;)t[r++]=e&255|Of,e>>>=7;return t[r]=e|0,Mf.bytes=r-n+1,t}var fg=js,ug=128,Ff=127;function js(e,n){var r=0,n=n||0,i=0,o=n,s,a=e.length;do{if(o>=a)throw js.bytes=0,new RangeError("Could not decode varint");s=e[o++],r+=i<28?(s&Ff)<<i:(s&Ff)*Math.pow(2,i),i+=7}while(s>=ug);return js.bytes=o-n,r}var hg=Math.pow(2,7),lg=Math.pow(2,14),pg=Math.pow(2,21),dg=Math.pow(2,28),yg=Math.pow(2,35),gg=Math.pow(2,42),xg=Math.pow(2,49),mg=Math.pow(2,56),bg=Math.pow(2,63),wg=function(e){return e<hg?1:e<lg?2:e<pg?3:e<dg?4:e<yg?5:e<gg?6:e<xg?7:e<mg?8:e<bg?9:10},vg={encode:og,decode:fg,encodingLength:wg},Eg=vg,jn=Eg;var Jn=(e,t=0)=>[jn.decode(e,t),jn.decode.bytes],pn=(e,t,r=0)=>(jn.encode(e,t,r),t),dn=e=>jn.encodingLength(e);var Oe=(e,t)=>{let r=t.byteLength,n=dn(e),i=n+dn(r),o=new Uint8Array(i+r);return pn(e,o,0),pn(r,o,n),o.set(t,i),new yn(e,r,t,o)},ti=e=>{let t=Je(e),[r,n]=Jn(t),[i,o]=Jn(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new yn(r,i,s,t)},Hf=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Nf(e.bytes,r.bytes)}},yn=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var ta=({name:e,code:t,encode:r})=>new Js(e,t,r),Js=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Oe(this.code,r):r.then(n=>Oe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var qf=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Yt=ta({name:"sha2-256",code:18,encode:qf("SHA-256")}),Sg=ta({name:"sha2-512",code:19,encode:qf("SHA-512")});var ra={};$t(ra,{identity:()=>mr});var zf=0,Bg="identity",Gf=Je,Ag=e=>Oe(zf,Gf(e)),mr={code:zf,name:Bg,encode:Gf,digest:Ag};var Zw=new TextEncoder,Yw=new TextDecoder;var $f=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return Tg(r,na(e),t||Zt.encoder);default:return Lg(r,na(e),t||xr.encoder)}};var Wf=new WeakMap,na=e=>{let t=Wf.get(e);if(t==null){let r=new Map;return Wf.set(e,r),r}return t},Tt=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==ei)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Rg)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Tt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Oe(t,r);return Tt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return Tt.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&Hf(t.multihash,n.multihash)}toString(t){return $f(this,t)}toJSON(){return{"/":$f(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof Tt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new Tt(n,i,o,s||Zf(n,i,o.bytes))}else if(r[Ng]===!0){let{version:n,multihash:i,code:o}=r,s=ti(i);return Tt.create(n,o,s)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==ei)throw new Error(`Version 0 CID must use dag-pb (code: ${ei}) block encoding`);return new Tt(t,r,n,n.bytes)}case 1:{let i=Zf(t,r,n.bytes);return new Tt(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return Tt.create(0,ei,t)}static createV1(t,r){return Tt.create(1,t,r)}static decode(t){let[r,n]=Tt.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=Tt.inspectBytes(t),n=r.size-r.multihashSize,i=Je(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new yn(r.multihashCode,r.digestSize,o,i);return[r.version===0?Tt.createV0(s):Tt.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=Jn(t.subarray(r));return r+=l,h},i=n(),o=ei;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),c=n(),f=r+c,u=f-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(t,r){let[n,i]=_g(t,r),o=Tt.decode(i);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return na(o).set(n,t),o}},_g=(e,t)=>{switch(e[0]){case"Q":{let r=t||Zt;return[Zt.prefix,r.decode(`${Zt.prefix}${e}`)]}case Zt.prefix:{let r=t||Zt;return[Zt.prefix,r.decode(e)]}case xr.prefix:{let r=t||xr;return[xr.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},Tg=(e,t,r)=>{let{prefix:n}=r;if(n!==Zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let o=r.encode(e).slice(1);return t.set(n,o),o}else return i},Lg=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let o=r.encode(e);return t.set(n,o),o}else return i},ei=112,Rg=18,Zf=(e,t,r)=>{let n=dn(e),i=n+dn(t),o=new Uint8Array(i+r.byteLength);return pn(e,o,0),pn(t,o,n),o.set(r,i),o},Ng=Symbol.for("@ipld/js-cid/CID");var xn={...Vs,...qs,...zs,...Gs,...$s,...Ws,...Zs,...Ys,...Xs,...Qs},ov={...ea,...ra};function Xf(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Yf=Xf("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ia=Xf("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=pe(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),kg={utf8:Yf,"utf-8":Yf,hex:xn.base16,latin1:ia,ascii:ia,binary:ia,...xn},fo=kg;function Xt(e,t="utf8"){let r=fo[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?nr(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var ka={};$t(ka,{Ed25519PrivateKey:()=>qr,Ed25519PublicKey:()=>ci,generateKeyPair:()=>h2,generateKeyPairFromSeed:()=>rh,unmarshalEd25519PrivateKey:()=>f2,unmarshalEd25519PublicKey:()=>u2});var Dg=_t(cn(),1);var qt=BigInt(0),at=BigInt(1),vr=BigInt(2),Ug=BigInt(8),Qf=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),vt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Qf,n:Qf,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var ru=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),ri=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),pv=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Pg=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Kg=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Og=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Fg=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),ot=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof At))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(At.ZERO)?ot.ZERO:new ot(t.x,t.y,at,_(t.x*t.y))}static toAffineBatch(t){let r=Vg(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){Jf(t);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=t,c=_(r*a),f=_(o*i),u=_(n*a),h=_(s*i);return c===f&&u===h}negate(){return new ot(_(-this.x),this.y,this.z,_(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=vt,o=_(t*t),s=_(r*r),a=_(vr*_(n*n)),c=_(i*o),f=t+r,u=_(_(f*f)-o-s),h=c+s,l=h-a,d=c-s,p=_(u*l),y=_(h*d),g=_(u*d),m=_(l*h);return new ot(p,y,m,g)}add(t){Jf(t);let{x:r,y:n,z:i,t:o}=this,{x:s,y:a,z:c,t:f}=t,u=_((n-r)*(a+s)),h=_((n+r)*(a-s)),l=_(h-u);if(l===qt)return this.double();let d=_(i*vr*f),p=_(o*vr*c),y=p+d,g=h+u,m=p-d,E=_(y*l),b=_(g*m),C=_(y*m),v=_(l*g);return new ot(E,b,v,C)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(t-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(t,r){!r&&this.equals(ot.BASE)&&(r=At.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&fa.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=ot.normalizeZ(i),fa.set(r,i)));let o=ot.ZERO,s=ot.BASE,a=1+256/n,c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(t&f);t>>=h,p>c&&(p-=u,t+=at);let y=d,g=d+Math.abs(p)-1,m=l%2!==0,E=p<0;p===0?s=s.add(jf(m,i[y])):o=o.add(jf(E,i[g]))}return ot.normalizeZ([o,s])[0]}multiply(t,r){return this.wNAF(ho(t,vt.l),r)}multiplyUnsafe(t){let r=ho(t,vt.l,!1),n=ot.BASE,i=ot.ZERO;if(r===qt)return i;if(this.equals(i)||r===at)return this;if(this.equals(n))return this.wNAF(r);let o=i,s=this;for(;r>qt;)r&at&&(o=o.add(s)),s=s.double(),r>>=at;return o}isSmallOrder(){return this.multiplyUnsafe(vt.h).equals(ot.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(vt.l/vr).double();return vt.l%vr&&(t=t.add(this)),t.equals(ot.ZERO)}toAffine(t){let{x:r,y:n,z:i}=this,o=this.equals(ot.ZERO);t==null&&(t=o?Ug:lo(i));let s=_(r*t),a=_(n*t),c=_(i*t);if(o)return At.ZERO;if(c!==at)throw new Error("invZ was invalid");return new At(s,a)}fromRistrettoBytes(){sa()}toRistrettoBytes(){sa()}fromRistrettoHash(){sa()}};ot.BASE=new ot(vt.Gx,vt.Gy,at,_(vt.Gx*vt.Gy));ot.ZERO=new ot(qt,at,at,qt);function jf(e,t){let r=t.negate();return e?r:t}function Jf(e){if(!(e instanceof ot))throw new TypeError("ExtendedPoint expected")}function oa(e){if(!(e instanceof ie))throw new TypeError("RistrettoPoint expected")}function sa(){throw new Error("Legacy method: switch to RistrettoPoint")}var ie=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=vt,n=_(ri*t*t),i=_((n+at)*Og),o=BigInt(-1),s=_((o-r*n)*_(n+r)),{isValid:a,value:c}=ha(i,s),f=_(c*t);wr(f)||(f=_(-f)),a||(c=f),a||(o=n);let u=_(o*(n-at)*Fg-s),h=c*c,l=_((c+c)*s),d=_(u*Pg),p=_(at-h),y=_(at+h);return new ot(_(l*y),_(p*d),_(d*y),_(l*p))}static hashToCurve(t){t=Er(t,64);let r=aa(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=aa(t.slice(32,64)),o=this.calcElligatorRistrettoMap(i);return new ie(n.add(o))}static fromHex(t){t=Er(t,32);let{a:r,d:n}=vt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",o=aa(t);if(!zg(ni(o),t)||wr(o))throw new Error(i);let s=_(o*o),a=_(at+r*s),c=_(at-r*s),f=_(a*a),u=_(c*c),h=_(r*n*f-u),{isValid:l,value:d}=eu(_(h*u)),p=_(d*c),y=_(d*p*h),g=_((o+o)*p);wr(g)&&(g=_(-g));let m=_(a*y),E=_(g*m);if(!l||wr(E)||m===qt)throw new Error(i);return new ie(new ot(g,m,at,E))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,o=_(_(n+r)*_(n-r)),s=_(t*r),a=_(s*s),{value:c}=eu(_(o*a)),f=_(c*o),u=_(c*s),h=_(f*u*i),l;if(wr(i*h)){let p=_(r*ri),y=_(t*ri);t=p,r=y,l=_(f*Kg)}else l=u;wr(t*h)&&(r=_(-r));let d=_((n-r)*l);return wr(d)&&(d=_(-d)),ni(d)}toHex(){return ii(this.toRawBytes())}toString(){return this.toHex()}equals(t){oa(t);let r=this.ep,n=t.ep,i=_(r.x*n.y)===_(r.y*n.x),o=_(r.y*n.y)===_(r.x*n.x);return i||o}add(t){return oa(t),new ie(this.ep.add(t.ep))}subtract(t){return oa(t),new ie(this.ep.subtract(t.ep))}multiply(t){return new ie(this.ep.multiply(t))}multiplyUnsafe(t){return new ie(this.ep.multiplyUnsafe(t))}};ie.BASE=new ie(ot.BASE);ie.ZERO=new ie(ot.ZERO);var fa=new WeakMap,At=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,fa.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=vt;t=Er(t,32);let o=t.slice();o[31]=t[31]&-129;let s=oi(o);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=ru)throw new Error("Expected 0 < hex < 2**256");let a=_(s*s),c=_(a-at),f=_(n*a+at),{isValid:u,value:h}=ha(c,f);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&at)===at;return(t[31]&128)!==0!==l&&(h=_(-h)),new At(h,s)}static async fromPrivateKey(t){return(await po(t)).point}toRawBytes(){let t=ni(this.y);return t[31]|=this.x&at?128:0,t}toHex(){return ii(this.toRawBytes())}toX25519(){let{y:t}=this,r=_((at+t)*lo(at-t));return ni(r)}isTorsionFree(){return ot.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new At(_(-this.x),this.y)}add(t){return ot.fromAffine(this).add(ot.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return ot.fromAffine(this).multiply(t,this).toAffine()}};At.BASE=new At(vt.Gx,vt.Gy);At.ZERO=new At(qt,at);var Pr=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=Er(t,64),n=At.fromHex(r.slice(0,32),!1),i=oi(r.slice(32,64));return new Pr(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof At))throw new Error("Expected Point instance");return ho(r,vt.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(ni(this.s),32),t}toHex(){return ii(this.toRawBytes())}};function tu(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let o=e[n];r.set(o,i),i+=o.length}return r}var Mg=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ii(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=Mg[e[r]];return t}function ua(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function nu(e){let r=e.toString(16).padStart(64,"0");return ua(r)}function ni(e){return nu(e).reverse()}function wr(e){return(_(e)&at)===at}function oi(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+ii(Uint8Array.from(e).reverse()))}var Hg=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function aa(e){return _(oi(e)&Hg)}function _(e,t=vt.P){let r=e%t;return r>=qt?r:t+r}function lo(e,t=vt.P){if(e===qt||t<=qt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=_(e,t),n=t,i=qt,o=at,s=at,a=qt;for(;r!==qt;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==at)throw new Error("invert: does not exist");return _(i,t)}function Vg(e,t=vt.P){let r=new Array(e.length),n=e.reduce((o,s,a)=>s===qt?o:(r[a]=o,_(o*s,t)),at),i=lo(n,t);return e.reduceRight((o,s,a)=>s===qt?o:(r[a]=_(o*r[a],t),_(o*s,t)),i),r}function Fe(e,t){let{P:r}=vt,n=e;for(;t-- >qt;)n*=n,n%=r;return n}function qg(e){let{P:t}=vt,r=BigInt(5),n=BigInt(10),i=BigInt(20),o=BigInt(40),s=BigInt(80),c=e*e%t*e%t,f=Fe(c,vr)*c%t,u=Fe(f,at)*e%t,h=Fe(u,r)*u%t,l=Fe(h,n)*h%t,d=Fe(l,i)*l%t,p=Fe(d,o)*d%t,y=Fe(p,s)*p%t,g=Fe(y,s)*p%t,m=Fe(g,n)*h%t;return{pow_p_5_8:Fe(m,vr)*e%t,b2:c}}function ha(e,t){let r=_(t*t*t),n=_(r*r*t),i=qg(e*n).pow_p_5_8,o=_(e*r*i),s=_(t*o*o),a=o,c=_(o*ri),f=s===e,u=s===_(-e),h=s===_(-e*ri);return f&&(o=a),(u||h)&&(o=c),wr(o)&&(o=_(-o)),{isValid:f||u,value:o}}function eu(e){return ha(at,e)}function uo(e){return _(oi(e),vt.l)}function zg(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Er(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):ua(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function ho(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(qt<e)return e}else if(qt<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Gg(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function $g(e){if(e=typeof e=="bigint"||typeof e=="number"?nu(ho(e,ru)):Er(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function Wg(e){let t=Gg(e.slice(0,32)),r=e.slice(32,64),n=uo(t),i=At.BASE.multiply(n),o=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:o}}var ca;async function po(e){return Wg(await Sr.sha512($g(e)))}async function la(e){return(await po(e)).pointBytes}async function iu(e,t){e=Er(e);let{prefix:r,scalar:n,pointBytes:i}=await po(t),o=uo(await Sr.sha512(r,e)),s=At.BASE.multiply(o),a=uo(await Sr.sha512(s.toRawBytes(),i,e)),c=_(o+a*n,vt.l);return new Pr(s,c).toRawBytes()}function Zg(e,t,r){t=Er(t),r instanceof At||(r=At.fromHex(r,!1));let{r:n,s:i}=e instanceof Pr?e.assertValidity():Pr.fromHex(e),o=ot.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:o,pub:r,msg:t}}function Yg(e,t,r,n){let i=uo(n),o=ot.fromAffine(e).multiplyUnsafe(i);return ot.fromAffine(t).add(o).subtract(r).multiplyUnsafe(vt.h).equals(ot.ZERO)}async function ou(e,t,r){let{r:n,SB:i,msg:o,pub:s}=Zg(e,t,r),a=await Sr.sha512(n.toRawBytes(),s.toRawBytes(),o);return Yg(s,n,i,a)}At.BASE._setWindowSize(8);var br={node:Dg,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Sr={bytesToHex:ii,hexToBytes:ua,concatBytes:tu,getExtendedPublicKey:po,mod:_,invert:lo,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=Er(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return _(oi(e),vt.l-at)+at},randomBytes:(e=32)=>{if(br.web)return br.web.getRandomValues(new Uint8Array(e));if(br.node){let{randomBytes:t}=br.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Sr.randomBytes(32),sha512:async(...e)=>{let t=tu(...e);if(br.web){let r=await br.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(br.node)return Uint8Array.from(br.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=At.BASE){let r=t.equals(At.BASE)?t:new At(t.x,t.y);return r._setWindowSize(e),r.multiply(vr),r},sha512Sync:void 0};Object.defineProperties(Sr,{sha512Sync:{configurable:!1,get(){return ca},set(e){ca||(ca=e)}}});var mn=32,tr=64,yo=32;async function su(){let e=Sr.randomPrivateKey(),t=await la(e);return{privateKey:uu(e,t),publicKey:t}}async function au(e){if(e.length!==yo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await la(t);return{privateKey:uu(t,r),publicKey:r}}async function cu(e,t){let r=e.subarray(0,yo);return iu(t,r)}async function fu(e,t,r){return ou(t,r,e)}function uu(e,t){let r=new Uint8Array(tr);for(let n=0;n<yo;n++)r[n]=e[n],r[yo+n]=t[n];return r}var oe={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var pa={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function da(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",o=e?.saltLength??16,s=e?.iterations??32767,a=oe.get();r*=8;async function c(h,l){let d=a.getRandomValues(new Uint8Array(o)),p=a.getRandomValues(new Uint8Array(n)),y={name:t,iv:p};typeof l=="string"&&(l=Xt(l));let g;if(l.length===0){g=await a.subtle.importKey("jwk",pa,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(E,b,{name:t,length:r},!0,["encrypt"])}catch{g=await a.subtle.importKey("jwk",pa,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(E,b,{name:t,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(y,g,h);return Kt([d,y.iv,new Uint8Array(m)])}async function f(h,l){let d=h.subarray(0,o),p=h.subarray(o,o+n),y=h.subarray(o+n),g={name:t,iv:p};typeof l=="string"&&(l=Xt(l));let m;if(l.length===0)try{let b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,C,{name:t,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",pa,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,C,{name:t,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(g,m,y);return new Uint8Array(E)}return{encrypt:c,decrypt:f}}async function bn(e,t){let n=await da().encrypt(e,t);return ln.encode(n)}var Ia=_t(ba(),1),ju=_t(zu(),1),Ju=_t(Or(),1),_a=_t(Ca(),1),th=_t(Qu(),1);function s2(){Ju.default._configure(),Ia.default._configure(ju.default),_a.default._configure(th.default)}s2();var eh=["uint64","int64","sint64","fixed64","sfixed64"];function a2(e){for(let t of eh){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Ta(e){return a2(new Ia.default(e))}function c2(e){for(let t of eh){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function La(){return c2(_a.default.create())}function Mr(e,t){let r=Ta(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Hr(e,t){let r=La();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var vn;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(vn||(vn={}));function wo(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Ra(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(o,s){let a=t(o);s.int32(a)},n=function(o){let s=o.int32();return t(s)};return wo("enum",vn.VARINT,r,n)}function Vr(e,t){return wo("message",vn.LENGTH_DELIMITED,e,t)}var Ct;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(Ct||(Ct={}));var Na;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(Na||(Na={}));(function(e){e.codec=()=>Ra(Na)})(Ct||(Ct={}));var Ve;(function(e){let t;e.codec=()=>(t==null&&(t=Vr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Ct.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),t),e.encode=r=>Hr(r,e.codec()),e.decode=r=>Mr(r,e.codec())})(Ve||(Ve={}));var qe;(function(e){let t;e.codec=()=>(t==null&&(t=Vr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Ct.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),t),e.encode=r=>Hr(r,e.codec()),e.decode=r=>Mr(r,e.codec())})(qe||(qe={}));var ci=class{_key;constructor(t){this._key=En(t,mn)}async verify(t,r){return fu(this._key,r,t)}marshal(){return this._key}get bytes(){return Ve.encode({Type:Ct.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}},qr=class{_key;_publicKey;constructor(t,r){this._key=En(t,tr),this._publicKey=En(r,mn)}async sign(t){return cu(this._key,t)}get public(){return new ci(this._publicKey)}marshal(){return this._key}get bytes(){return qe.encode({Type:Ct.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}async id(){let t=mr.digest(this.public.bytes);return Zt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return bn(this.bytes,t);throw new xt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function f2(e){if(e.length>tr){e=En(e,tr+mn);let n=e.subarray(0,tr),i=e.subarray(tr,e.length);return new qr(n,i)}e=En(e,tr);let t=e.subarray(0,tr),r=e.subarray(mn);return new qr(t,r)}function u2(e){return e=En(e,mn),new ci(e)}async function h2(){let{privateKey:e,publicKey:t}=await su();return new qr(e,t)}async function rh(e){let{privateKey:t,publicKey:r}=await au(e);return new qr(t,r)}function En(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new xt(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function Lt(e,t="utf8"){let r=fo[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var n8=_t(Pt(),1),i8=_t(io(),1),nh=_t(gt(),1);function Ie(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Kt([new Uint8Array(t-r.length),r])}return Lt(r,"base64url")}function fe(e){let t=ih(e);return new nh.default.jsbn.BigInteger(Lt(t,"base16"),16)}function ih(e,t){let r=Xt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Kt([new Uint8Array(t-r.length),r])}return r}var l2={"P-256":256,"P-384":384,"P-521":521},p2=Object.keys(l2),y8=p2.join(" / ");var za={};$t(za,{RsaPrivateKey:()=>Tn,RsaPublicKey:()=>yi,fromJwk:()=>F2,generateKeyPair:()=>M2,unmarshalRsaPrivateKey:()=>K2,unmarshalRsaPublicKey:()=>O2});var di=_t(gt(),1);var J8=_t(fh(),1);var g2=_t(cn(),1);var ct=BigInt(0),St=BigInt(1),Ir=BigInt(2),hi=BigInt(3),uh=BigInt(8),kt=Object.freeze({a:ct,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:St,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),hh=(e,t)=>(e+t/Ir)/t,Eo={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=kt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-St*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=hh(o*e,t),c=hh(-n*e,t),f=O(e-a*r-c*i,t),u=O(-a*n-c*o,t),h=f>s,l=u>s;if(h&&(f=t-f),l&&(u=t-u),f>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:f,k2neg:l,k2:u}}},_e=32,An=32,x2=32,lh=_e+1,ph=2*_e+1;function dh(e){let{a:t,b:r}=kt,n=O(e*e),i=O(n*e);return O(i+t*e+r)}var So=kt.a===ct,Co=class extends Error{constructor(t){super(t)}};function yh(e){if(!(e instanceof lt))throw new TypeError("JacobianPoint expected")}var lt=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof dt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(dt.ZERO)?lt.ZERO:new lt(t.x,t.y,St)}static toAffineBatch(t){let r=E2(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return lt.toAffineBatch(t).map(lt.fromAffine)}equals(t){yh(t);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=t,c=O(i*i),f=O(a*a),u=O(r*f),h=O(o*c),l=O(O(n*a)*f),d=O(O(s*i)*c);return u===h&&l===d}negate(){return new lt(this.x,O(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=O(t*t),o=O(r*r),s=O(o*o),a=t+o,c=O(Ir*(O(a*a)-i-s)),f=O(hi*i),u=O(f*f),h=O(u-Ir*c),l=O(f*(c-h)-uh*s),d=O(Ir*r*n);return new lt(h,l,d)}add(t){yh(t);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=t;if(o===ct||s===ct)return this;if(r===ct||n===ct)return t;let c=O(i*i),f=O(a*a),u=O(r*f),h=O(o*c),l=O(O(n*a)*f),d=O(O(s*i)*c),p=O(h-u),y=O(d-l);if(p===ct)return y===ct?this.double():lt.ZERO;let g=O(p*p),m=O(p*g),E=O(u*g),b=O(y*y-m-Ir*E),C=O(y*(E-b)-l*m),v=O(i*a*p);return new lt(b,C,v)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=lt.ZERO;if(typeof t=="bigint"&&t===ct)return r;let n=mh(t);if(n===St)return this;if(!So){let h=r,l=this;for(;n>ct;)n&St&&(h=h.add(l)),l=l.double(),n>>=St;return h}let{k1neg:i,k1:o,k2neg:s,k2:a}=Eo.splitScalar(n),c=r,f=r,u=this;for(;o>ct||a>ct;)o&St&&(c=c.add(u)),a&St&&(f=f.add(u)),u=u.double(),o>>=St,a>>=St;return i&&(c=c.negate()),s&&(f=f.negate()),f=new lt(O(f.x*Eo.beta),f.y,f.z),c.add(f)}precomputeWindow(t){let r=So?128/t+1:256/t+1,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(t-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(t,r){!r&&this.equals(lt.BASE)&&(r=dt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ka.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=lt.normalizeZ(i),Ka.set(r,i)));let o=lt.ZERO,s=lt.BASE,a=1+(So?128/n:256/n),c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(t&f);t>>=h,p>c&&(p-=u,t+=St);let y=d,g=d+Math.abs(p)-1,m=l%2!==0,E=p<0;p===0?s=s.add(Bo(m,i[y])):o=o.add(Bo(E,i[g]))}return{p:o,f:s}}multiply(t,r){let n=mh(t),i,o;if(So){let{k1neg:s,k1:a,k2neg:c,k2:f}=Eo.splitScalar(n),{p:u,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(f,r);u=Bo(s,u),l=Bo(c,l),l=new lt(O(l.x*Eo.beta),l.y,l.z),i=u.add(l),o=h.add(d)}else{let{p:s,f:a}=this.wNAF(n,r);i=s,o=a}return lt.normalizeZ([i,o])[0]}toAffine(t){let{x:r,y:n,z:i}=this,o=this.equals(lt.ZERO);t==null&&(t=o?uh:_n(i));let s=t,a=O(s*s),c=O(a*s),f=O(r*a),u=O(n*c),h=O(i*s);if(o)return dt.ZERO;if(h!==St)throw new Error("invZ was invalid");return new dt(f,u)}};lt.BASE=new lt(kt.Gx,kt.Gy,St);lt.ZERO=new lt(ct,St,ct);function Bo(e,t){let r=t.negate();return e?r:t}var Ka=new WeakMap,dt=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Ka.delete(this)}hasEvenY(){return this.y%Ir===ct}static fromCompressedHex(t){let r=t.length===32,n=_r(r?t:t.subarray(1));if(!Pa(n))throw new Error("Point is not on curve");let i=dh(n),o=v2(i),s=(o&St)===St;r?s&&(o=O(-o)):(t[0]&1)===1!==s&&(o=O(-o));let a=new dt(n,o);return a.assertValidity(),a}static fromUncompressedHex(t){let r=_r(t.subarray(1,_e+1)),n=_r(t.subarray(_e+1,_e*2+1)),i=new dt(r,n);return i.assertValidity(),i}static fromHex(t){let r=In(t),n=r.length,i=r[0];if(n===_e)return this.fromCompressedHex(r);if(n===lh&&(i===2||i===3))return this.fromCompressedHex(r);if(n===ph&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${lh} compressed bytes or ${ph} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return dt.BASE.multiply(_o(t))}static fromSignature(t,r,n){let{r:i,s:o}=bh(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let s=Ma(In(t)),{n:a}=kt,c=n===2||n===3?i+a:i,f=_n(c,a),u=O(-s*f,a),h=O(o*f,a),l=n&1?"03":"02",d=dt.fromHex(l+Sn(c)),p=dt.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(t=!1){return Gr(this.toHex(t))}toHex(t=!1){let r=Sn(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${Sn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!Pa(r)||!Pa(n))throw new Error(t);let i=O(n*n),o=dh(r);if(O(i-o)!==ct)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new dt(this.x,O(-this.y))}double(){return lt.fromAffine(this).double().toAffine()}add(t){return lt.fromAffine(this).add(lt.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return lt.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=lt.fromAffine(this),o=r===ct||r===St||this!==dt.BASE?i.multiplyUnsafe(r):i.multiply(r),s=lt.fromAffine(t).multiplyUnsafe(n),a=o.add(s);return a.equals(lt.ZERO)?void 0:a.toAffine()}};dt.BASE=new dt(kt.Gx,kt.Gy);dt.ZERO=new dt(ct,ct);function gh(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function xh(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${Cn(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:_r(r),left:e.subarray(t+2)}}function m2(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${Cn(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=xh(e.subarray(2)),{data:n,left:i}=xh(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Cn(i)}`);return{r:t,s:n}}var ze=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Cn(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ze(Io(i.slice(0,64)),Io(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=m2(r?t:Gr(t));return new ze(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!pi(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!pi(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=kt.n>>St;return this.s>t}normalizeS(){return this.hasHighS()?new ze(this.r,O(-this.s,kt.n)):this}toDERRawBytes(){return Gr(this.toDERHex())}toDERHex(){let t=gh(ui(this.s)),r=gh(ui(this.r)),n=t.length/2,i=r.length/2,o=ui(n),s=ui(i);return`30${ui(i+n+4)}02${s}${r}02${o}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Gr(this.toCompactHex())}toCompactHex(){return Sn(this.r)+Sn(this.s)}};function Cr(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let o=e[n];r.set(o,i),i+=o.length}return r}var b2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Cn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=b2[e[r]];return t}var w2=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Sn(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(ct<=e&&e<w2))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function Oa(e){let t=Gr(Sn(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function ui(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Io(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function Gr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function _r(e){return Io(Cn(e))}function In(e){return e instanceof Uint8Array?Uint8Array.from(e):Gr(e)}function mh(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&pi(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function O(e,t=kt.P){let r=e%t;return r>=ct?r:t+r}function be(e,t){let{P:r}=kt,n=e;for(;t-- >ct;)n*=n,n%=r;return n}function v2(e){let{P:t}=kt,r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),c=e*e*e%t,f=c*c*e%t,u=be(f,hi)*f%t,h=be(u,hi)*f%t,l=be(h,Ir)*c%t,d=be(l,n)*l%t,p=be(d,i)*d%t,y=be(p,s)*p%t,g=be(y,a)*y%t,m=be(g,s)*p%t,E=be(m,hi)*f%t,b=be(E,o)*d%t,C=be(b,r)*c%t,v=be(C,Ir);if(v*v%t!==e)throw new Error("Cannot find square root");return v}function _n(e,t=kt.P){if(e===ct||t<=ct)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=O(e,t),n=t,i=ct,o=St,s=St,a=ct;for(;r!==ct;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==St)throw new Error("invert: does not exist");return O(i,t)}function E2(e,t=kt.P){let r=new Array(e.length),n=e.reduce((o,s,a)=>s===ct?o:(r[a]=o,O(o*s,t)),St),i=_n(n,t);return e.reduceRight((o,s,a)=>s===ct?o:(r[a]=O(o*r[a],t),O(o*s,t)),i),r}function S2(e){let t=e.length*8-An*8,r=_r(e);return t>0?r>>BigInt(t):r}function Ma(e,t=!1){let r=S2(e);if(t)return r;let{n}=kt;return r>=n?r-n:r}var Bn,li,Fa=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Te.hmacSha256(this.k,...t)}hmacSync(...t){return li(this.k,...t)}checkSync(){if(typeof li!="function")throw new Co("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return Cr(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return Cr(...r)}};function pi(e){return ct<e&&e<kt.n}function Pa(e){return ct<e&&e<kt.P}function B2(e,t,r,n=!0){let{n:i}=kt,o=Ma(e,!0);if(!pi(o))return;let s=_n(o,i),a=dt.BASE.multiply(o),c=O(a.x,i);if(c===ct)return;let f=O(s*O(t+r*c,i),i);if(f===ct)return;let u=new ze(c,f),h=(a.x===u.r?0:2)|Number(a.y&St);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function _o(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*An)throw new Error("Expected 32 bytes of private key");t=Io(e)}else if(e instanceof Uint8Array){if(e.length!==An)throw new Error("Expected 32 bytes of private key");t=_r(e)}else throw new TypeError("Expected valid private key");if(!pi(t))throw new Error("Expected private key: 0 < key < n");return t}function A2(e){return e instanceof dt?(e.assertValidity(),e):dt.fromHex(e)}function bh(e){if(e instanceof ze)return e.assertValidity(),e;try{return ze.fromDER(e)}catch{return ze.fromCompact(e)}}function Ha(e,t=!1){return dt.fromPrivateKey(e).toRawBytes(t)}function wh(e){let t=e.length>_e?e.slice(0,_e):e;return _r(t)}function C2(e){let t=wh(e),r=O(t,kt.n);return vh(r<ct?t:r)}function vh(e){return Oa(e)}function I2(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=In(e),i=_o(t),o=[vh(i),C2(n)];if(r!=null){r===!0&&(r=Te.randomBytes(_e));let c=In(r);if(c.length!==_e)throw new Error(`sign: Expected ${_e} bytes of extra data`);o.push(c)}let s=Cr(...o),a=wh(n);return{seed:s,m:a,d:i}}function _2(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:o}=Object.assign({canonical:!0,der:!0},t),s=i?r.toDERRawBytes():r.toCompactRawBytes();return o?[s,n]:s}async function Eh(e,t,r={}){let{seed:n,m:i,d:o}=I2(e,t,r.extraEntropy),s=new Fa(x2,An);await s.reseed(n);let a;for(;!(a=B2(await s.generate(),i,o,r.canonical));)await s.reseed();return _2(a,r)}var T2={strict:!0};function Sh(e,t,r,n=T2){let i;try{i=bh(e),t=In(t)}catch{return!1}let{r:o,s}=i;if(n.strict&&i.hasHighS())return!1;let a=Ma(t),c;try{c=A2(r)}catch{return!1}let{n:f}=kt,u=_n(s,f),h=O(a*u,f),l=O(o*u,f),d=dt.BASE.multiplyAndAddUnsafe(c,h,l);return d?O(d.x,f)===o:!1}dt.BASE._setWindowSize(8);var ue={node:g2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Ao={},Te={bytesToHex:Cn,hexToBytes:Gr,concatBytes:Cr,mod:O,invert:_n,isValidPrivateKey(e){try{return _o(e),!0}catch{return!1}},_bigintTo32Bytes:Oa,_normalizePrivateKey:_o,hashToPrivateKey:e=>{e=In(e);let t=An+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=O(_r(e),kt.n-St)+St;return Oa(r)},randomBytes:(e=32)=>{if(ue.web)return ue.web.getRandomValues(new Uint8Array(e));if(ue.node){let{randomBytes:t}=ue.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Te.hashToPrivateKey(Te.randomBytes(An+8)),precompute(e=8,t=dt.BASE){let r=t===dt.BASE?t:new dt(t.x,t.y);return r._setWindowSize(e),r.multiply(hi),r},sha256:async(...e)=>{if(ue.web){let t=await ue.web.subtle.digest("SHA-256",Cr(...e));return new Uint8Array(t)}else if(ue.node){let{createHash:t}=ue.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ue.web){let r=await ue.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Cr(...t),i=await ue.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(ue.node){let{createHmac:r}=ue.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=Ao[e];if(r===void 0){let n=await Te.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=Cr(n,n),Ao[e]=r}return Te.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof Bn!="function")throw new Co("sha256Sync is undefined, you need to set it");let r=Ao[e];if(r===void 0){let n=Bn(Uint8Array.from(e,i=>i.charCodeAt(0)));r=Cr(n,n),Ao[e]=r}return Bn(r,...t)},_JacobianPoint:lt};Object.defineProperties(Te,{sha256Sync:{configurable:!1,get(){return Bn},set(e){Bn||(Bn=e)}},hmacSha256Sync:{configurable:!1,get(){return li},set(e){li||(li=e)}}});function To(e){if(isNaN(e)||e<=0)throw new xt("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Te.randomBytes(e)}var U8=_t(ao(),1),Va=_t(gt(),1);function Bh(e,t){return t.map(r=>fe(e[r]))}function Ah(e){return Va.default.pki.setRsaPrivateKey(...Bh(e,["n","e","d","p","q","dp","dq","qi"]))}function Ch(e){return Va.default.pki.setRsaPublicKey(...Bh(e,["n","e"]))}var $r={};$t($r,{jwkToPkcs1:()=>N2,jwkToPkix:()=>D2,pkcs1ToJwk:()=>R2,pkixToJwk:()=>k2});var O8=_t(Yn(),1),F8=_t(ao(),1);var er=_t(gt(),1);function R2(e){let t=er.default.asn1.fromDer(Lt(e,"ascii")),r=er.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Ie(r.n),e:Ie(r.e),d:Ie(r.d),p:Ie(r.p),q:Ie(r.q),dp:Ie(r.dP),dq:Ie(r.dQ),qi:Ie(r.qInv),alg:"RS256"}}function N2(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new xt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=er.default.pki.privateKeyToAsn1({n:fe(e.n),e:fe(e.e),d:fe(e.d),p:fe(e.p),q:fe(e.q),dP:fe(e.dp),dQ:fe(e.dq),qInv:fe(e.qi)});return Xt(er.default.asn1.toDer(t).getBytes(),"ascii")}function k2(e){let t=er.default.asn1.fromDer(Lt(e,"ascii")),r=er.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Ie(r.n),e:Ie(r.e)}}function D2(e){if(e.n==null||e.e==null)throw new xt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=er.default.pki.publicKeyToAsn1({n:fe(e.n),e:fe(e.e)});return Xt(er.default.asn1.toDer(t).getBytes(),"ascii")}async function Ih(e){let t=await oe.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Lh(t);return{privateKey:r[0],publicKey:r[1]}}async function qa(e){let r=[await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await U2(e)],n=await Lh({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function _h(e,t){let r=await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await oe.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Th(e,t,r){let n=await oe.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return oe.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function Lh(e){if(e.privateKey==null||e.publicKey==null)throw new xt("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([oe.get().subtle.exportKey("jwk",e.privateKey),oe.get().subtle.exportKey("jwk",e.publicKey)])}async function U2(e){return oe.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Rh(e,t,r,n){let i=t?Ch(e):Ah(e),o=Lt(Uint8Array.from(r),"ascii"),s=n(o,i);return Xt(s,"ascii")}function Nh(e,t){return Rh(e,!0,t,(r,n)=>n.encrypt(r))}function kh(e,t){return Rh(e,!1,t,(r,n)=>n.decrypt(r))}var yi=class{_key;constructor(t){this._key=t}async verify(t,r){return Th(this._key,r,t)}marshal(){return $r.jwkToPkix(this._key)}get bytes(){return Ve.encode({Type:Ct.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Nh(this._key,t)}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}},Tn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return To(16)}async sign(t){return _h(this._key,t)}get public(){if(this._publicKey==null)throw new xt("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new yi(this._publicKey)}decrypt(t){return kh(this._key,t)}marshal(){return $r.jwkToPkcs1(this._key)}get bytes(){return qe.encode({Type:Ct.RSA,Data:this.marshal()}).subarray()}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return Lt(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new di.default.util.ByteBuffer(this.marshal()),i=di.default.asn1.fromDer(n),o=di.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return di.default.pki.encryptRsaPrivateKey(o,t,s)}else{if(r==="libp2p-key")return bn(this.bytes,t);throw new xt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function K2(e){let t=$r.pkcs1ToJwk(e),r=await qa(t);return new Tn(r.privateKey,r.publicKey)}function O2(e){let t=$r.pkixToJwk(e);return new yi(t)}async function F2(e){let t=await qa(e);return new Tn(t.privateKey,t.publicKey)}async function M2(e){let t=await Ih(e);return new Tn(t.privateKey,t.publicKey)}var $a={};$t($a,{Secp256k1PrivateKey:()=>xi,Secp256k1PublicKey:()=>gi,generateKeyPair:()=>z2,unmarshalSecp256k1PrivateKey:()=>V2,unmarshalSecp256k1PublicKey:()=>q2});function Dh(){return Te.randomPrivateKey()}async function Uh(e,t){let{digest:r}=await Yt.digest(t);try{return await Eh(r,e)}catch(n){throw new xt(String(n),"ERR_INVALID_INPUT")}}async function Ph(e,t,r){try{let{digest:n}=await Yt.digest(r);return Sh(t,n,e)}catch(n){throw new xt(String(n),"ERR_INVALID_INPUT")}}function Kh(e){return dt.fromHex(e).toRawBytes(!0)}function Oh(e){try{Ha(e,!0)}catch(t){throw new xt(String(t),"ERR_INVALID_PRIVATE_KEY")}}function Ga(e){try{dt.fromHex(e)}catch(t){throw new xt(String(t),"ERR_INVALID_PUBLIC_KEY")}}function Fh(e){try{return Ha(e,!0)}catch(t){throw new xt(String(t),"ERR_INVALID_PRIVATE_KEY")}}var gi=class{_key;constructor(t){Ga(t),this._key=t}async verify(t,r){return Ph(this._key,r,t)}marshal(){return Kh(this._key)}get bytes(){return Ve.encode({Type:Ct.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}},xi=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r??Fh(t),Oh(this._key),Ga(this._publicKey)}async sign(t){return Uh(this._key,t)}get public(){return new gi(this._publicKey)}marshal(){return this._key}get bytes(){return qe.encode({Type:Ct.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Ft(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Yt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return Lt(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return bn(this.bytes,t);throw new xt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function V2(e){return new xi(e)}function q2(e){return new gi(e)}async function z2(){let e=Dh();return new xi(e)}var Wr={rsa:za,ed25519:ka,secp256k1:$a};function Mh(e){let t=Object.keys(Wr).join(" / ");return new xt(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Hh(e){let t=Ve.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case Ct.RSA:return Wr.rsa.unmarshalRsaPublicKey(r);case Ct.Ed25519:return Wr.ed25519.unmarshalEd25519PublicKey(r);case Ct.Secp256k1:return Wr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Mh(t.Type??"RSA")}}async function Vh(e){let t=qe.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case Ct.RSA:return Wr.rsa.unmarshalRsaPrivateKey(r);case Ct.Ed25519:return Wr.ed25519.unmarshalEd25519PrivateKey(r);case Ct.Secp256k1:return Wr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Mh(t.Type??"RSA")}}var qh=Symbol.for("@libp2p/peer-id");var $2=Symbol.for("nodejs.util.inspect.custom"),zh=Object.values(xn).map(e=>e.decoder).reduce((e,t)=>e.or(t),xn.identity.decoder),Gh=114,Wa=36,Za=37,mi=class{type;multihash;privateKey;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[qh]=!0;toString(){return this.string==null&&(this.string=Zt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Tt.createV1(Gh,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Ft(this.multihash.bytes,t);if(typeof t=="string")return W2(t).equals(this);if(t?.multihash?.bytes!=null)return Ft(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[$2](){return`PeerId(${this.toString()})`}},Ln=class extends mi{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Rn=class extends mi{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.multihash.digest}},Nn=class extends mi{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.multihash.digest}};function W2(e,t){if(t=t??zh,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=ti(Zt.decode(`z${e}`));return e.startsWith("12D")?new Rn({multihash:r}):e.startsWith("16U")?new Nn({multihash:r}):new Ln({multihash:r})}return Z2(zh.decode(e))}function Z2(e){try{let t=ti(e);if(t.code===mr.code){if(t.digest.length===Wa)return new Rn({multihash:t});if(t.digest.length===Za)return new Nn({multihash:t})}if(t.code===Yt.code)return new Ln({multihash:t})}catch{return Y2(Tt.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Y2(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==Gh)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Yt.code)return new Ln({multihash:e.multihash});if(t.code===mr.code){if(t.digest.length===Wa)return new Rn({multihash:e.multihash});if(t.digest.length===Za)return new Nn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Ya(e,t){return e.length===Wa?new Rn({multihash:Oe(mr.code,e),privateKey:t}):e.length===Za?new Nn({multihash:Oe(mr.code,e),privateKey:t}):new Ln({multihash:await Yt.digest(e),publicKey:e,privateKey:t})}var Lo;(function(e){let t;e.codec=()=>(t==null&&(t=Vr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let o of r.webtransportCerthashes)n.uint32(10),n.bytes(o);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(s&7);break}}return i})),t),e.encode=r=>Hr(r,e.codec()),e.decode=r=>Mr(r,e.codec())})(Lo||(Lo={}));var bi;(function(e){let t;e.codec=()=>(t==null&&(t=Vr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),Lo.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=Lo.codec().decode(r,r.uint32());break;default:r.skipType(s&7);break}}return i})),t),e.encode=r=>Hr(r,e.codec()),e.decode=r=>Mr(r,e.codec())})(bi||(bi={}));async function $h(e,t,r){let n=await Q2(e,Wh(t));if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return X2(e.publicKey,n,r)}function X2(e,t,r){return bi.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function Q2(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Vh(e.privateKey)).sign(t)}async function Xa(e){return Ya(e.identityKey)}function Qa(e){return bi.decode(e)}function Wh(e){let t=Xt("noise-libp2p-static-key:");return Kt([t,e],t.length+e.length)}async function ja(e,t,r){let n=await Ya(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=Wh(e);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await Hh(n.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function wi(e){return!(!(e instanceof Uint8Array)||e.length!==32)}var le=_t(jh(),1);le.default.formatters.b=e=>e==null?"undefined":Zt.baseEncode(e);le.default.formatters.t=e=>e==null?"undefined":xr.baseEncode(e);le.default.formatters.m=e=>e==null?"undefined":ln.baseEncode(e);le.default.formatters.p=e=>e==null?"undefined":e.toString();le.default.formatters.c=e=>e==null?"undefined":e.toString();le.default.formatters.k=e=>e==null?"undefined":e.toString();le.default.formatters.a=e=>e==null?"undefined":e.toString();function ux(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function Jh(e){let t=ux(`${e}:trace`);return le.default.enabled(`${e}:trace`)&&le.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=(0,le.default)(`${e}:trace`)),Object.assign((0,le.default)(e),{error:(0,le.default)(`${e}:error`),trace:t})}var Gt=Jh("libp2p:noise");var we;E0?we=Gt:we=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function tl(e){we(`LOCAL_STATIC_PUBLIC_KEY ${Lt(e.publicKey,"hex")}`),we(`LOCAL_STATIC_PRIVATE_KEY ${Lt(e.privateKey,"hex")}`)}function Ja(e){e?(we(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Lt(e.publicKey,"hex")}`),we(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Lt(e.privateKey,"hex")}`)):we("Missing local ephemeral keys.")}function el(e){we(`REMOTE_STATIC_PUBLIC_KEY ${Lt(e,"hex")}`)}function t0(e){we(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Lt(e,"hex")}`)}function rl(e){e.cs1&&e.cs2?(we(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${Lt(e.cs1.k,"hex")}`),we(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${Lt(e.cs2.k,"hex")}`)):we("Missing cipher state.")}var hx="Cipherstate has reached maximum n, a new handshake must be performed",ko=class{n;bytes;view;constructor(t=0){this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(hx)}};var Do=class{crypto;constructor(t){this.crypto=t}encryptWithAd(t,r,n){let i=this.encrypt(t.k,t.n,r,n);return t.n.increment(),i}decryptWithAd(t,r,n,i){let{plaintext:o,valid:s}=this.decrypt(t.k,t.n,r,n,i);return s&&t.n.increment(),{plaintext:o,valid:s}}hasKey(t){return!this.isEmptyKey(t.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(t){let r=this.createEmptyKey();return Ft(r,t)}encrypt(t,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,t)}encryptAndHash(t,r){let n;return this.hasKey(t.cs)?n=this.encryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,n),n}decrypt(t,r,n,i,o){r.assertValue();let s=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,t,o);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(t,r){let n,i=!0;return this.hasKey(t.cs)?{plaintext:n,valid:i}=this.decryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,r),{plaintext:n,valid:i}}dh(t,r){try{let n=this.crypto.generateX25519SharedKey(t,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Gt.error(i),new Uint8Array(32)}}mixHash(t,r){t.h=this.getHash(t.h,r)}getHash(t,r){return this.crypto.hashSHA256(Kt([t,r],t.length+r.length))}mixKey(t,r){let[n,i]=this.crypto.getHKDF(t.ck,r);t.cs=this.initializeKey(i),t.ck=n}initializeKey(t){return{k:t,n:new ko}}initializeSymmetric(t){let r=Xt(t,"utf-8"),n=this.hashProtocolName(r),i=n,o=this.createEmptyKey();return{cs:this.initializeKey(o),ck:i,h:n}}hashProtocolName(t){if(t.length<=32){let r=new Uint8Array(32);return r.set(t),r}else return this.getHash(t,new Uint8Array(0))}split(t){let[r,n]=this.crypto.getHKDF(t.ck,new Uint8Array(0)),i=this.initializeKey(r),o=this.initializeKey(n);return{cs1:i,cs2:o}}writeMessageRegular(t,r){let n=this.encryptWithAd(t,new Uint8Array(0),r),i=this.createEmptyKey(),o=new Uint8Array(0);return{ne:i,ns:o,ciphertext:n}}readMessageRegular(t,r){return this.decryptWithAd(t,new Uint8Array(0),r.ciphertext)}};var Uo=class extends Do{initializeInitiator(t,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,t);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}initializeResponder(t,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,t);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}writeMessageA(t,r,n){let i=new Uint8Array(0);n!==void 0?t.e=n:t.e=this.crypto.generateX25519KeyPair();let o=t.e.publicKey;this.mixHash(t.ss,o);let s=this.encryptAndHash(t.ss,r);return{ne:o,ns:i,ciphertext:s}}writeMessageB(t,r){t.e=this.crypto.generateX25519KeyPair();let n=t.e.publicKey;this.mixHash(t.ss,n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let i=t.s.publicKey,o=this.encryptAndHash(t.ss,i);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let s=this.encryptAndHash(t.ss,r);return{ne:n,ns:o,ciphertext:s}}writeMessageC(t,r){let n=t.s.publicKey,i=this.encryptAndHash(t.ss,n);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let o=this.encryptAndHash(t.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:o},{cs1:c,cs2:f}=this.split(t.ss);return{h:t.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(t,r){return wi(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),this.decryptAndHash(t.ss,r.ciphertext)}readMessageB(t,r){if(wi(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);i&&wi(n)&&(t.rs=n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:o,valid:s}=this.decryptAndHash(t.ss,r.ciphertext);return{plaintext:o,valid:i&&s}}readMessageC(t,r){let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);if(i&&wi(n)&&(t.rs=n),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:o,valid:s}=this.decryptAndHash(t.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(t.ss);return{h:t.ss.h,plaintext:o,valid:i&&s,cs1:a,cs2:c}}initSession(t,r,n){let i=this.createEmptyKey(),o=new Uint8Array(32),s;return t?s=this.initializeInitiator(r,n,o,i):s=this.initializeResponder(r,n,o,i),{hs:s,i:t,mc:0}}sendMessage(t,r,n){let i;if(t.mc===0)i=this.writeMessageA(t.hs,r,n);else if(t.mc===1)i=this.writeMessageB(t.hs,r);else if(t.mc===2){let{h:o,messageBuffer:s,cs1:a,cs2:c}=this.writeMessageC(t.hs,r);i=s,t.h=o,t.cs1=a,t.cs2=c}else if(t.mc>2)if(t.i){if(!t.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(t.cs1,r)}else{if(!t.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(t.cs2,r)}else throw new Error("Session invalid.");return t.mc++,i}recvMessage(t,r){let n=new Uint8Array(0),i=!1;if(t.mc===0)({plaintext:n,valid:i}=this.readMessageA(t.hs,r));else if(t.mc===1)({plaintext:n,valid:i}=this.readMessageB(t.hs,r));else if(t.mc===2){let{h:o,plaintext:s,valid:a,cs1:c,cs2:f}=this.readMessageC(t.hs,r);n=s,i=a,t.h=o,t.cs1=c,t.cs2=f}return t.mc++,{plaintext:n,valid:i}}};var Po=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(t,r,n,i,o,s,a,c){this.isInitiator=t,this.payload=r,this.prologue=n,this.staticKeypair=o,this.connection=s,a&&(this.remotePeer=a),this.xx=c??new Uo(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(tl(this.session.hs.s),this.isInitiator){Gt.trace("Stage 0 - Initiator starting to send first message.");let t=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(ic(t)),Gt.trace("Stage 0 - Initiator finished sending first message."),Ja(this.session.hs.e)}else{Gt.trace("Stage 0 - Responder waiting to receive first message...");let t=ac((await this.connection.readLP()).subarray()),{valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new hr("xx handshake stage 0 validation fail");Gt.trace("Stage 0 - Responder received first message."),t0(this.session.hs.re)}}async exchange(){if(this.isInitiator){Gt.trace("Stage 1 - Initiator waiting to receive first message from responder...");let t=cc((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new hr("xx handshake stage 1 validation fail");Gt.trace("Stage 1 - Initiator received the message."),t0(this.session.hs.re),el(this.session.hs.rs),Gt.trace("Initiator going to check remote's signature...");try{let i=Qa(r);this.remotePeer=this.remotePeer||await Xa(i),await ja(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new on(`Error occurred while verifying signed payload: ${o.message}`)}Gt.trace("All good with the signature!")}else{Gt.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(oc(t)),Gt.trace("Stage 1 - Responder sent the second handshake message with signed payload."),Ja(this.session.hs.e)}}async finish(){if(this.isInitiator){Gt.trace("Stage 2 - Initiator sending third handshake message.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(sc(t)),Gt.trace("Stage 2 - Initiator sent message with signed payload.")}else{Gt.trace("Stage 2 - Responder waiting for third handshake message...");let t=fc((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new hr("xx handshake stage 2 validation fail");Gt.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=Qa(r);this.remotePeer=this.remotePeer||await Xa(i),await ja(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new on(`Error occurred while verifying signed payload: ${o.message}`)}}rl(this.session)}encrypt(t,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),t)}decrypt(t,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),t,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(t,r=!0){if(!t.cs1||!t.cs2)throw new hr("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?t.cs1:t.cs2:r?t.cs2:t.cs1}setRemoteNoiseExtension(t){t&&(this.remoteExtensions=t)}};function nl(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Ko=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(t={}){let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:o,metrics:s}=t;this.crypto=i??zi,this.extensions=n,this.metrics=s?nl(s):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=o??new Uint8Array(0)}async secureOutbound(t,r,n){let i=qo(r,{lengthEncoder:nn,lengthDecoder:zn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remoteExtensions:o.remoteExtensions,remotePeer:o.remotePeer}}async secureInbound(t,r,n){let i=qo(r,{lengthEncoder:nn,lengthDecoder:zn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remotePeer:o.remotePeer,remoteExtensions:o.remoteExtensions}}async performHandshake(t){let r=await $h(t.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(t,r)}async performXXHandshake(t,r){let{isInitiator:n,remotePeer:i,connection:o}=t,s=new Po(n,r,this.prologue,this.crypto,this.staticKeys,o,i);try{await s.propose(),await s.exchange(),await s.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return s}async createSecureConnection(t,r){let[n,i]=g0(),o=t.unwrap();return await b0(n,lc(r,this.metrics),o,s=>Kn(s,{lengthDecoder:zn}),pc(r,this.metrics),n),i}};function lx(e={}){return()=>new Ko(e)}return ml(px);})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
